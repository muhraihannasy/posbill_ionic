{"version":3,"sources":["webpack:///src/app/help-chat/help-chat.page.html","webpack:///src/app/help-chat/help-chat.page.scss","webpack:///src/app/chat-box/chat-box.component.html","webpack:///src/app/chat-box/chat-box.component.ts","webpack:///src/app/help-chat/help-chat.page.ts","webpack:///node_modules/@firebase/storage/dist/index.esm.js","webpack:///src/app/help-chat/help-chat-routing.module.ts","webpack:///node_modules/@angular/fire/__ivy_ngcc__/fesm2015/angular-fire-storage.js","webpack:///node_modules/firebase/storage/dist/index.esm.js","webpack:///src/app/help-chat/help-chat.module.ts","webpack:///src/app/chat-box/chat-box.component.scss","webpack:///src/app/help-chat/help-chat.service.ts"],"names":["ChatBoxComponent","selector","template","Camera","HelpChatPage","popoverController","http","global","storage","chat","name","message","isLoading","chats","id","sender","getObject","then","data","room","read","body","admin_Id","unread","createDialog","event","create","component","translucent","componentProps","title","popover","present","getPhoto","quality","allowEditing","resultType","Uri","image","imageUrl","webPath","console","log","currentUserId","createRoom","DEFAULT_HOST","CONFIG_STORAGE_BUCKET_KEY","DEFAULT_MAX_OPERATION_RETRY_TIME","DEFAULT_MAX_UPLOAD_RETRY_TIME","FirebaseStorageError","code","code_","prependCode","message_","serverResponse_","name_","prototype","codeProp","codeEquals","serverResponseProp","setServerResponseProp","serverResponse","Object","defineProperty","get","enumerable","configurable","Code","UNKNOWN","OBJECT_NOT_FOUND","BUCKET_NOT_FOUND","PROJECT_NOT_FOUND","QUOTA_EXCEEDED","UNAUTHENTICATED","UNAUTHORIZED","RETRY_LIMIT_EXCEEDED","INVALID_CHECKSUM","CANCELED","INVALID_EVENT_NAME","INVALID_URL","INVALID_DEFAULT_BUCKET","NO_DEFAULT_BUCKET","CANNOT_SLICE_BLOB","SERVER_FILE_WRONG_SIZE","NO_DOWNLOAD_URL","INVALID_ARGUMENT","INVALID_ARGUMENT_COUNT","APP_DELETED","INVALID_ROOT_OPERATION","INVALID_FORMAT","INTERNAL_ERROR","unknown","objectNotFound","path","quotaExceeded","bucket","unauthenticated","unauthorized","retryLimitExceeded","canceled","invalidUrl","url","invalidDefaultBucket","cannotSliceBlob","serverFileWrongSize","noDownloadURL","invalidArgument","index","fnName","invalidArgumentCount","argMin","argMax","real","countPart","plural","appDeleted","invalidRootOperation","invalidFormat","format","internalError","StringFormat","RAW","BASE64","BASE64URL","DATA_URL","formatValidator","stringFormat","StringData","contentType","dataFromString","stringData","utf8Bytes_","base64Bytes_","dataURLBytes_","dataURLContentType_","value","b","i","length","c","charCodeAt","push","valid","hi","lo","Uint8Array","percentEncodedBytes_","decoded","decodeURIComponent","e","hasMinus","indexOf","hasUnder","invalidChar","hasPlus","hasSlash","replace","bytes","atob","array","DataURLParts","dataURL","base64","matches","match","middle","endsWith","substring","rest","dataUrl","parts","s","end","longEnough","TaskEvent","STATE_CHANGED","InternalTaskState","RUNNING","PAUSING","PAUSED","SUCCESS","CANCELING","ERROR","TaskState","taskStateFromInternalTaskState","state","isDef","p","isJustDef","isFunction","isObject","isNonNullObject","isNonArrayObject","Array","isArray","isString","String","isInteger","isNumber","Number","isNativeBlob","isNativeBlobDefined","Blob","ErrorCode","NetworkXhrIo","_this","sent_","xhr_","XMLHttpRequest","errorCode_","NO_ERROR","sendPromise_","Promise","resolve","addEventListener","ABORT","NETWORK_ERROR","send","method","headers","open","key","hasOwnProperty","setRequestHeader","toString","getErrorCode","getStatus","status","getResponseText","responseText","abort","getResponseHeader","header","addUploadProgressListener","listener","upload","removeUploadProgressListener","removeEventListener","XhrIoPool","createXhrIo","getBlobBuilder","BlobBuilder","WebKitBlobBuilder","undefined","getBlob","args","_i","arguments","bb","append","Error","sliceBlob","blob","start","webkitSlice","mozSlice","slice","FbsBlob","elideCopy","size","blobType","data_","type","ArrayBuffer","byteLength","set","size_","type_","startByte","endByte","realBlob","sliced","buffer","blobby","map","val","apply","uint8Arrays","finalLength_1","forEach","merged_1","index_1","uploadData","Location","path_","fullServerUrl","encode","encodeURIComponent","bucketOnlyServerUrl","makeFromBucketSpec","bucketString","bucketLocation","makeFromUrl","location","bucketDomain","gsModify","loc","charAt","gsPath","gsRegex","RegExp","gsIndices","httpModify","version","firebaseStorageHost","firebaseStoragePath","firebaseStorageRegExp","firebaseStorageIndices","cloudStorageHost","cloudStoragePath","cloudStorageRegExp","cloudStorageIndices","groups","regex","indices","postModify","group","captures","exec","bucketValue","pathValue","jsonObjectOrNull","obj","JSON","parse","parent","lastIndexOf","newPath","child","childPath","canonicalChildPath","split","filter","join","lastComponent","makeUrl","urlPart","makeQueryString","params","queryPart","nextPart","noXform_","metadata","Mapping","server","local","writable","xform","mappings_","xformPath","fullPath","getMappings","mappings","mappingsXformPath","_metadata","nameMapping","xformSize","sizeMapping","addRef","service","generateRef","makeStorageReference","fromResource","resource","len","mapping","fromResourceString","resourceString","downloadUrlFromResourceString","tokens","tokensList","urls","token","base","queryString","alt","toResourceString","stringify","metadataValidator","MAX_RESULTS_KEY","MAX_MAX_RESULTS","PAGE_TOKEN_KEY","PREFIXES_KEY","ITEMS_KEY","fromBackendResponse","listResult","prefixes","items","nextPageToken","_a","pathWithoutTrailingSlash","reference","_b","_c","item","fromResponseString","listOptionsValidator","RequestInfo","handler","timeout","urlParams","errorHandler","progressCallback","successCodes","additionalRetryCodes","handlerCheck","cndn","metadataHandler","xhr","text","listHandler","downloadUrlHandler","sharedErrorHandler","err","newErr","objectErrorHandler","shared","getMetadata","maxOperationRetryTime","requestInfo","list","delimiter","pageToken","maxResults","isRoot","getDownloadUrl","updateMetadata","deleteObject","_xhr","_text","determineContentType_","metadataForUpload_","metadataClone","assign","multipartUpload","genBoundary","str","Math","random","boundary","metadata_","metadataString","preBlobPart","postBlobPart","maxUploadRetryTime","ResumableUploadStatus","current","total","finalized","checkResumeHeader_","allowed","allowedStatus","createResumableUpload","metadataForUpload","getResumableUploadStatus","sizeString","isNaN","resumableUploadChunkSize","continueResumableUpload","chunkSize","status_","bytesLeft","bytesToUpload","min","uploadCommand","uploadStatus","newCurrent","Observer","nextOrObserver","error","complete","asFunctions","next","observer","UploadTaskSnapshot","bytesTransferred","totalBytes","task","ref","validate","specs","passed","minArgs","maxArgs","optional","validLength","validator","ArgSpec","self","and_","v1","v2","stringSpec","stringValidator","chainedValidator","uploadDataSpec","metadataSpec","listOptionSpec","nonNegativeNumberSpec","looseObjectSpec","isLooseObjectValidator","isLooseObject","nullFunctionSpec","async","f","argsToForward","UploadTask","transferred_","needToFetchStatus_","needToFetchMetadata_","observers_","error_","uploadUrl_","request_","chunkMultiplier_","resolve_","reject_","ref_","service_","location_","blob_","resumable_","shouldDoResumable_","state_","errorHandler_","completeTransitions_","transition_","metadataErrorHandler_","promise_","reject","start_","makeProgressCallback_","sizeBefore","loaded","updateProgress_","createResumable_","fetchStatus_","fetchMetadata_","continueUpload_","oneShotUpload_","resolveToken_","callback","getAuthToken","authToken","createRequest","makeRequest","getPromise","statusRequest","uploadRequest","newStatus","increaseMultiplier_","currentSize","metadataRequest","multipartRequest","transferred","old","notifyObservers_","cancel","wasPaused","externalState","on","completed","typeValidator","nextOrObserverMessage","nextValidator","observerValidator","nextOrObserverValidator","anyDefined","makeBinder","binder","addObserver_","removeObserver_","binderNextOrObserverValidator","binderSpecs","typeOnly","onFulfilled","onRejected","notifyObserver_","splice","finishPromise_","observers","triggered","bind","snapshot","toCall","resume","pause","Reference","newRef","put","throwIfRoot_","putString","listAll","accumulator","listAllHelper","opt","nextPage","label","sent","options","op","getDownloadURL","FailRequest","_appDelete","waitSeconds","timeoutId","hitTimeout","cancelState","triggeredCallback","triggerCallback","callWithDelay","millis","setTimeout","success","call","mustStop","waitMillis","stopped","stop","wasTimeout","clearTimeout","NetworkRequest","errorCallback","pool","pendingXhr_","backoffId_","canceled_","appDelete_","url_","method_","headers_","body_","successCodes_","additionalRetryCodes_","callback_","errorCallback_","progressCallback_","timeout_","pool_","doTheRequest","backoffCallback","RequestEndStatus","progressListener","progressEvent","lengthComputable","hitServer","isRetryStatusCode_","wasCanceled","successCode","backoffDone","requestWentThrough","wasSuccessCode","result","appDelete","isFiveHundredCode","extraRetryCodes","isExtraRetryCode","isRequestSpecificRetryCode","addAuthHeader_","addVersionHeader_","SDK_VERSION","addGmpidHeader_","appId","StorageService","app","authProvider","bucket_","appId_","deleted_","app_","authProvider_","maxOperationRetryTime_","maxUploadRetryTime_","requests_","Set","extractBucket_","internals_","ServiceInternals","config","auth","tokenData","getImmediate","getToken","accessToken","deleteApp","request","clear","request_1","add","test","refFromURL","setMaxUploadRetryTime","time","setMaxOperationRetryTime","STORAGE_TYPE","factory","container","getProvider","registerStorage","instance","namespaceExports","Storage","INTERNAL","registerComponent","setServiceProps","setMultipleInstances","registerVersion","routes","HelpChatPageRoutingModule","imports","forChild","exports","fromTask","subscriber","progress","snap","AngularFireUploadTask","createUploadTask","inner$","snapshotChanges","percentageChanges","pipe","AngularFireStorageReference","createStorageRef","schedulers","keepUnstableUntilFirst","outsideAngular","meta","BUCKET","AngularFireStorage","nameOrConfig","storageBucket","platformId","zone","runOutsideAngular","storageRef","ɵfac","AngularFireStorage_Factory","t","ctorParameters","decorators","ɵprov","providedIn","AngularFireStorageModule","ɵmod","ɵinj","AngularFireStorageModule_Factory","providers","HelpChatPageModule","declarations","HelpChatService","db","dialog","dialogsRef","object","messagesRef","content","timestamp","Date","now","file","filePath","uploadTask","downloadUrl$","subscribe","downloadUrl","valueChanges"],"mappings":"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","file":"help-chat-help-chat-module-es5.js","sourcesContent":["export default \"<ion-header>\\r\\n  <ion-toolbar color=\\\"primary\\\">\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-button fill=\\\"clear\\\" id=\\\"popover\\\" (click)=\\\"showPopover($event)\\\">\\r\\n        <ion-icon name=\\\"arrow-back-outline\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n\\r\\n    <ion-title>Admin Posbill</ion-title>\\r\\n    <ion-buttons slot=\\\"end\\\">\\r\\n      <ion-button fill=\\\"clear\\\" id=\\\"popover\\\" (click)=\\\"showPopover($event)\\\">\\r\\n        <ion-icon name=\\\"ellipsis-vertical-outline\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </ion-buttons>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n  <ion-list lines=\\\"none\\\" *ngIf=\\\"(chats) as chat$\\\">\\r\\n    <ion-item-group class=\\\"chats-group\\\" *ngFor=\\\"let chat of chat$\\\">\\r\\n      <app-chat-box\\r\\n        [chat]=\\\"chat\\\"\\r\\n        [current_user_id]=\\\"currentUserId\\\"\\r\\n      ></app-chat-box>\\r\\n    </ion-item-group>\\r\\n  </ion-list>\\r\\n</ion-content>\\r\\n\\r\\n<ion-footer>\\r\\n  <ion-toolbar>\\r\\n    <div class=\\\"wrapper-footer\\\">\\r\\n      <div class=\\\"input\\\">\\r\\n        <input type=\\\"text\\\" class=\\\"input-message\\\" [(ngModel)]=\\\"message\\\" />\\r\\n\\r\\n        <div class=\\\"attachments\\\">\\r\\n          <div class=\\\"attach\\\">\\r\\n            <ion-icon name=\\\"attach-outline\\\"></ion-icon>\\r\\n          </div>\\r\\n          <div class=\\\"attach\\\" (click)=\\\"takePicture()\\\">\\r\\n            <ion-icon name=\\\"camera-outline\\\"></ion-icon>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n\\r\\n      <ion-button (click)=\\\"sendMessage()\\\">\\r\\n        <ion-icon name=\\\"send\\\"></ion-icon>\\r\\n      </ion-button>\\r\\n    </div>\\r\\n  </ion-toolbar>\\r\\n</ion-footer>\\r\\n\";","export default \".input-message {\\n  border: none;\\n  background: transparent;\\n}\\n\\n.input-message:focus {\\n  outline: none;\\n}\\n\\n.wrapper-footer {\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  gap: 1em;\\n  padding: 0 1em;\\n}\\n\\n.wrapper-footer .input {\\n  flex: 1;\\n  display: flex;\\n  flex-direction: row;\\n  align-items: center;\\n  justify-content: space-between;\\n  border-radius: 1.5em;\\n  overflow: hidden;\\n  padding: 0.6em;\\n  background-color: #f0f0f0;\\n}\\n\\n.wrapper-footer .input input {\\n  width: 90%;\\n}\\n\\n.wrapper-footer .input .attachments {\\n  display: flex;\\n  align-items: center;\\n  gap: 0.4em;\\n  padding-right: 0.4em;\\n}\\n\\n.wrapper-footer .input .attachments .attach {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  font-size: 1.4em;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uXFwuLlxcLi5cXGhlbHAtY2hhdC5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxZQUFBO0VBQ0EsdUJBQUE7QUFDRjs7QUFFQTtFQUNFLGFBQUE7QUFDRjs7QUFFQTtFQUNFLGFBQUE7RUFDQSxtQkFBQTtFQUNBLDhCQUFBO0VBQ0EsUUFBQTtFQUNBLGNBQUE7QUFDRjs7QUFFQTtFQUNFLE9BQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSxtQkFBQTtFQUNBLDhCQUFBO0VBQ0Esb0JBQUE7RUFDQSxnQkFBQTtFQUNBLGNBQUE7RUFDQSx5QkFBQTtBQUNGOztBQUNBO0VBQ0UsVUFBQTtBQUVGOztBQUNBO0VBQ0UsYUFBQTtFQUNBLG1CQUFBO0VBQ0EsVUFBQTtFQUNBLG9CQUFBO0FBRUY7O0FBQ0E7RUFDRSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSx1QkFBQTtFQUNBLGdCQUFBO0FBRUYiLCJmaWxlIjoiaGVscC1jaGF0LnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5pbnB1dC1tZXNzYWdlIHtcclxuICBib3JkZXI6IG5vbmU7XHJcbiAgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQ7XHJcbn1cclxuXHJcbi5pbnB1dC1tZXNzYWdlOmZvY3VzIHtcclxuICBvdXRsaW5lOiBub25lO1xyXG59XHJcblxyXG4ud3JhcHBlci1mb290ZXIge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgZ2FwOiAxZW07XHJcbiAgcGFkZGluZzogMCAxZW07XHJcbn1cclxuXHJcbi53cmFwcGVyLWZvb3RlciAuaW5wdXQge1xyXG4gIGZsZXg6IDE7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBmbGV4LWRpcmVjdGlvbjogcm93O1xyXG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuO1xyXG4gIGJvcmRlci1yYWRpdXM6IDEuNWVtO1xyXG4gIG92ZXJmbG93OiBoaWRkZW47XHJcbiAgcGFkZGluZzogMC42ZW07XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogI2YwZjBmMDtcclxufVxyXG4ud3JhcHBlci1mb290ZXIgLmlucHV0IGlucHV0IHtcclxuICB3aWR0aDogOTAlO1xyXG59XHJcblxyXG4ud3JhcHBlci1mb290ZXIgLmlucHV0IC5hdHRhY2htZW50cyB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gIGdhcDogMC40ZW07XHJcbiAgcGFkZGluZy1yaWdodDogMC40ZW07XHJcbn1cclxuXHJcbi53cmFwcGVyLWZvb3RlciAuaW5wdXQgLmF0dGFjaG1lbnRzIC5hdHRhY2gge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcclxuICBmb250LXNpemU6IDEuNGVtO1xyXG59XHJcblxyXG5pb24tYnV0dG9uIHtcclxufVxyXG4iXX0= */\";","export default \"<ion-item\\r\\n  lines=\\\"none\\\"\\r\\n  [class]=\\\"chat?.sender != current_user_id ? 'sender' : 'user'\\\"\\r\\n>\\r\\n  <div\\r\\n    [slot]=\\\"chat?.sender == current_user_id ? 'end' : 'start'\\\"\\r\\n    class=\\\"ion-text-wrap\\\"\\r\\n  >\\r\\n    <div slot=\\\"end\\\" class=\\\"detail-info\\\">\\r\\n      <!-- <small>{{ chat?.createdAt?.toDate() | date : \\\"HH:mm\\\" }}</small> -->\\r\\n      <small>{{ chat?.sender != current_user_id ? \\\"Admin\\\" : \\\"Saya\\\" }}</small>\\r\\n      <small>10:00 AM</small>\\r\\n    </div>\\r\\n\\r\\n    <div\\r\\n      [class]=\\\"\\r\\n        chat?.sender != current_user_id ? 'chat-box sender' : 'chat-box user'\\r\\n      \\\"\\r\\n    >\\r\\n      <ion-text>{{ chat?.message }}</ion-text>\\r\\n    </div>\\r\\n  </div>\\r\\n</ion-item>\\r\\n\";","import { Component, Input, OnInit } from \"@angular/core\";\r\n\r\n@Component({\r\n  selector: \"app-chat-box\",\r\n  templateUrl: \"./chat-box.component.html\",\r\n  styleUrls: [\"./chat-box.component.scss\"],\r\n})\r\nexport class ChatBoxComponent implements OnInit {\r\n  @Input() chat: any;\r\n  @Input() current_user_id: any;\r\n\r\n  constructor() {}\r\n\r\n  ngOnInit() {}\r\n}\r\n","import { Component, OnInit } from \"@angular/core\";\r\nimport { PopoverController } from \"@ionic/angular\";\r\n\r\nimport { Plugins, CameraResultType } from \"@capacitor/core\";\r\nconst { Camera } = Plugins;\r\n\r\nimport { PopoverChatComponent } from \"../popover-chat/popover-chat.component\";\r\nimport { HttpClient } from \"@angular/common/http\";\r\nimport { GlobalService } from \"../global.service\";\r\nimport { StorageService } from \"../storage.service\";\r\nimport { HelpChatService } from \"./help-chat.service\";\r\n\r\n@Component({\r\n  selector: \"app-help-chat\",\r\n  templateUrl: \"./help-chat.page.html\",\r\n  styleUrls: [\"./help-chat.page.scss\"],\r\n})\r\nexport class HelpChatPage implements OnInit {\r\n  name: string = \"Sender\";\r\n  message: string = \"\";\r\n  isLoading = false;\r\n\r\n  currentUserId: any;\r\n\r\n  chats = [\r\n    { id: 1, sender: 1, message: \"hi\" },\r\n    { id: 3, sender: 3, message: \"hi ther\" },\r\n    {\r\n      id: 3,\r\n      sender: 3,\r\n      message:\r\n        \"Lorem ipsum dolor sit amet consectetur, adipisicing elit. Reprehenderit totam iste deserunt, alias sunt corporis quaerat voluptates fugiat aut eveniet.\",\r\n    },\r\n    { id: 3, sender: 3, message: \"hi ther\" },\r\n    { id: 3, sender: 3, message: \"hi ther\" },\r\n    { id: 3, sender: 1, message: \"hi ther\" },\r\n    { id: 3, sender: 1, message: \"hi ther\" },\r\n    { id: 3, sender: 1, message: \"hi ther\" },\r\n    { id: 3, sender: 1, message: \"hi ther\" },\r\n    { id: 3, sender: 1, message: \"hi ther\" },\r\n    { id: 3, sender: 1, message: \"hi ther\" },\r\n    { id: 3, sender: 1, message: \"hi ther\" },\r\n  ];\r\n\r\n  constructor(\r\n    private popoverController: PopoverController,\r\n    private http: HttpClient,\r\n    private global: GlobalService,\r\n    private storage: StorageService,\r\n    private chat: HelpChatService\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.storage.getObject(\"user\").then((data) => {\r\n      // this.currentUserId = data?.id;\r\n    });\r\n  }\r\n\r\n  createRoom(id: any) {\r\n    const room = {\r\n      read: {\r\n        id: \"e65fec28-028f-11ee-be56-0242ac120002\",\r\n        body: \"Read dialog bodys\",\r\n        admin_Id: \"admin_id\",\r\n      },\r\n      unread: {\r\n        id: \"eb544080-028f-11ee-be56-0242ac120002\",\r\n        body: \"asdasd\",\r\n        admin_Id: \"admin_id\",\r\n      },\r\n    };\r\n    this.chat.createDialog(room);\r\n  }\r\n\r\n  async showPopover(event: Event) {\r\n    const popover = await this.popoverController.create({\r\n      component: PopoverChatComponent,\r\n      event: event,\r\n      translucent: true,\r\n      componentProps: {\r\n        title: \"Judul Popover\",\r\n        message: \"Ini adalah isi pesan popover.\",\r\n      },\r\n    });\r\n    return await popover.present();\r\n  }\r\n\r\n  async takePicture() {\r\n    const image = await Camera.getPhoto({\r\n      quality: 90,\r\n      allowEditing: true,\r\n      resultType: CameraResultType.Uri,\r\n    });\r\n\r\n    const imageUrl = image.webPath;\r\n    console.log(imageUrl);\r\n  }\r\n\r\n  sendMessage() {\r\n    console.log(this.message, this.currentUserId);\r\n    this.createRoom(this.currentUserId);\r\n    // const coba = this.chat.getMessages().subscribe((dialog) => {\r\n    //   console.log(dialog);\r\n    // });\r\n  }\r\n}\r\n","import firebase from '@firebase/app';\nimport { __awaiter, __generator, __spreadArrays } from 'tslib';\nimport { Component } from '@firebase/component';\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @fileoverview Constants used in the Firebase Storage library.\r\n */\r\n/**\r\n * Domain name for firebase storage.\r\n */\r\nvar DEFAULT_HOST = 'firebasestorage.googleapis.com';\r\n/**\r\n * The key in Firebase config json for the storage bucket.\r\n */\r\nvar CONFIG_STORAGE_BUCKET_KEY = 'storageBucket';\r\n/**\r\n * 2 minutes\r\n *\r\n * The timeout for all operations except upload.\r\n */\r\nvar DEFAULT_MAX_OPERATION_RETRY_TIME = 2 * 60 * 1000;\r\n/**\r\n * 10 minutes\r\n *\r\n * The timeout for upload.\r\n */\r\nvar DEFAULT_MAX_UPLOAD_RETRY_TIME = 10 * 60 * 1000;\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar FirebaseStorageError = /** @class */ (function () {\r\n    function FirebaseStorageError(code, message) {\r\n        this.code_ = prependCode(code);\r\n        this.message_ = 'Firebase Storage: ' + message;\r\n        this.serverResponse_ = null;\r\n        this.name_ = 'FirebaseError';\r\n    }\r\n    FirebaseStorageError.prototype.codeProp = function () {\r\n        return this.code;\r\n    };\r\n    FirebaseStorageError.prototype.codeEquals = function (code) {\r\n        return prependCode(code) === this.codeProp();\r\n    };\r\n    FirebaseStorageError.prototype.serverResponseProp = function () {\r\n        return this.serverResponse_;\r\n    };\r\n    FirebaseStorageError.prototype.setServerResponseProp = function (serverResponse) {\r\n        this.serverResponse_ = serverResponse;\r\n    };\r\n    Object.defineProperty(FirebaseStorageError.prototype, \"name\", {\r\n        get: function () {\r\n            return this.name_;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FirebaseStorageError.prototype, \"code\", {\r\n        get: function () {\r\n            return this.code_;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FirebaseStorageError.prototype, \"message\", {\r\n        get: function () {\r\n            if (this.serverResponse_) {\r\n                return this.message_ + '\\n' + this.serverResponse_;\r\n            }\r\n            else {\r\n                return this.message_;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FirebaseStorageError.prototype, \"serverResponse\", {\r\n        get: function () {\r\n            return this.serverResponse_;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return FirebaseStorageError;\r\n}());\r\nvar Code = {\r\n    // Shared between all platforms\r\n    UNKNOWN: 'unknown',\r\n    OBJECT_NOT_FOUND: 'object-not-found',\r\n    BUCKET_NOT_FOUND: 'bucket-not-found',\r\n    PROJECT_NOT_FOUND: 'project-not-found',\r\n    QUOTA_EXCEEDED: 'quota-exceeded',\r\n    UNAUTHENTICATED: 'unauthenticated',\r\n    UNAUTHORIZED: 'unauthorized',\r\n    RETRY_LIMIT_EXCEEDED: 'retry-limit-exceeded',\r\n    INVALID_CHECKSUM: 'invalid-checksum',\r\n    CANCELED: 'canceled',\r\n    // JS specific\r\n    INVALID_EVENT_NAME: 'invalid-event-name',\r\n    INVALID_URL: 'invalid-url',\r\n    INVALID_DEFAULT_BUCKET: 'invalid-default-bucket',\r\n    NO_DEFAULT_BUCKET: 'no-default-bucket',\r\n    CANNOT_SLICE_BLOB: 'cannot-slice-blob',\r\n    SERVER_FILE_WRONG_SIZE: 'server-file-wrong-size',\r\n    NO_DOWNLOAD_URL: 'no-download-url',\r\n    INVALID_ARGUMENT: 'invalid-argument',\r\n    INVALID_ARGUMENT_COUNT: 'invalid-argument-count',\r\n    APP_DELETED: 'app-deleted',\r\n    INVALID_ROOT_OPERATION: 'invalid-root-operation',\r\n    INVALID_FORMAT: 'invalid-format',\r\n    INTERNAL_ERROR: 'internal-error'\r\n};\r\nfunction prependCode(code) {\r\n    return 'storage/' + code;\r\n}\r\nfunction unknown() {\r\n    var message = 'An unknown error occurred, please check the error payload for ' +\r\n        'server response.';\r\n    return new FirebaseStorageError(Code.UNKNOWN, message);\r\n}\r\nfunction objectNotFound(path) {\r\n    return new FirebaseStorageError(Code.OBJECT_NOT_FOUND, \"Object '\" + path + \"' does not exist.\");\r\n}\r\nfunction quotaExceeded(bucket) {\r\n    return new FirebaseStorageError(Code.QUOTA_EXCEEDED, \"Quota for bucket '\" +\r\n        bucket +\r\n        \"' exceeded, please view quota on \" +\r\n        'https://firebase.google.com/pricing/.');\r\n}\r\nfunction unauthenticated() {\r\n    var message = 'User is not authenticated, please authenticate using Firebase ' +\r\n        'Authentication and try again.';\r\n    return new FirebaseStorageError(Code.UNAUTHENTICATED, message);\r\n}\r\nfunction unauthorized(path) {\r\n    return new FirebaseStorageError(Code.UNAUTHORIZED, \"User does not have permission to access '\" + path + \"'.\");\r\n}\r\nfunction retryLimitExceeded() {\r\n    return new FirebaseStorageError(Code.RETRY_LIMIT_EXCEEDED, 'Max retry time for operation exceeded, please try again.');\r\n}\r\nfunction canceled() {\r\n    return new FirebaseStorageError(Code.CANCELED, 'User canceled the upload/download.');\r\n}\r\nfunction invalidUrl(url) {\r\n    return new FirebaseStorageError(Code.INVALID_URL, \"Invalid URL '\" + url + \"'.\");\r\n}\r\nfunction invalidDefaultBucket(bucket) {\r\n    return new FirebaseStorageError(Code.INVALID_DEFAULT_BUCKET, \"Invalid default bucket '\" + bucket + \"'.\");\r\n}\r\nfunction cannotSliceBlob() {\r\n    return new FirebaseStorageError(Code.CANNOT_SLICE_BLOB, 'Cannot slice blob for upload. Please retry the upload.');\r\n}\r\nfunction serverFileWrongSize() {\r\n    return new FirebaseStorageError(Code.SERVER_FILE_WRONG_SIZE, 'Server recorded incorrect upload file size, please retry the upload.');\r\n}\r\nfunction noDownloadURL() {\r\n    return new FirebaseStorageError(Code.NO_DOWNLOAD_URL, 'The given file does not have any download URLs.');\r\n}\r\nfunction invalidArgument(index, fnName, message) {\r\n    return new FirebaseStorageError(Code.INVALID_ARGUMENT, 'Invalid argument in `' + fnName + '` at index ' + index + ': ' + message);\r\n}\r\nfunction invalidArgumentCount(argMin, argMax, fnName, real) {\r\n    var countPart;\r\n    var plural;\r\n    if (argMin === argMax) {\r\n        countPart = argMin;\r\n        plural = argMin === 1 ? 'argument' : 'arguments';\r\n    }\r\n    else {\r\n        countPart = 'between ' + argMin + ' and ' + argMax;\r\n        plural = 'arguments';\r\n    }\r\n    return new FirebaseStorageError(Code.INVALID_ARGUMENT_COUNT, 'Invalid argument count in `' +\r\n        fnName +\r\n        '`: Expected ' +\r\n        countPart +\r\n        ' ' +\r\n        plural +\r\n        ', received ' +\r\n        real +\r\n        '.');\r\n}\r\nfunction appDeleted() {\r\n    return new FirebaseStorageError(Code.APP_DELETED, 'The Firebase app was deleted.');\r\n}\r\n/**\r\n * @param name The name of the operation that was invalid.\r\n */\r\nfunction invalidRootOperation(name) {\r\n    return new FirebaseStorageError(Code.INVALID_ROOT_OPERATION, \"The operation '\" +\r\n        name +\r\n        \"' cannot be performed on a root reference, create a non-root \" +\r\n        \"reference using child, such as .child('file.png').\");\r\n}\r\n/**\r\n * @param format The format that was not valid.\r\n * @param message A message describing the format violation.\r\n */\r\nfunction invalidFormat(format, message) {\r\n    return new FirebaseStorageError(Code.INVALID_FORMAT, \"String does not match format '\" + format + \"': \" + message);\r\n}\r\n/**\r\n * @param message A message describing the internal error.\r\n */\r\nfunction internalError(message) {\r\n    throw new FirebaseStorageError(Code.INTERNAL_ERROR, 'Internal error: ' + message);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar StringFormat = {\r\n    RAW: 'raw',\r\n    BASE64: 'base64',\r\n    BASE64URL: 'base64url',\r\n    DATA_URL: 'data_url'\r\n};\r\nfunction formatValidator(stringFormat) {\r\n    switch (stringFormat) {\r\n        case StringFormat.RAW:\r\n        case StringFormat.BASE64:\r\n        case StringFormat.BASE64URL:\r\n        case StringFormat.DATA_URL:\r\n            return;\r\n        default:\r\n            throw ('Expected one of the event types: [' +\r\n                StringFormat.RAW +\r\n                ', ' +\r\n                StringFormat.BASE64 +\r\n                ', ' +\r\n                StringFormat.BASE64URL +\r\n                ', ' +\r\n                StringFormat.DATA_URL +\r\n                '].');\r\n    }\r\n}\r\n/**\r\n * @struct\r\n */\r\nvar StringData = /** @class */ (function () {\r\n    function StringData(data, contentType) {\r\n        this.data = data;\r\n        this.contentType = contentType || null;\r\n    }\r\n    return StringData;\r\n}());\r\nfunction dataFromString(format, stringData) {\r\n    switch (format) {\r\n        case StringFormat.RAW:\r\n            return new StringData(utf8Bytes_(stringData));\r\n        case StringFormat.BASE64:\r\n        case StringFormat.BASE64URL:\r\n            return new StringData(base64Bytes_(format, stringData));\r\n        case StringFormat.DATA_URL:\r\n            return new StringData(dataURLBytes_(stringData), dataURLContentType_(stringData));\r\n        // do nothing\r\n    }\r\n    // assert(false);\r\n    throw unknown();\r\n}\r\nfunction utf8Bytes_(value) {\r\n    var b = [];\r\n    for (var i = 0; i < value.length; i++) {\r\n        var c = value.charCodeAt(i);\r\n        if (c <= 127) {\r\n            b.push(c);\r\n        }\r\n        else {\r\n            if (c <= 2047) {\r\n                b.push(192 | (c >> 6), 128 | (c & 63));\r\n            }\r\n            else {\r\n                if ((c & 64512) === 55296) {\r\n                    // The start of a surrogate pair.\r\n                    var valid = i < value.length - 1 && (value.charCodeAt(i + 1) & 64512) === 56320;\r\n                    if (!valid) {\r\n                        // The second surrogate wasn't there.\r\n                        b.push(239, 191, 189);\r\n                    }\r\n                    else {\r\n                        var hi = c;\r\n                        var lo = value.charCodeAt(++i);\r\n                        c = 65536 | ((hi & 1023) << 10) | (lo & 1023);\r\n                        b.push(240 | (c >> 18), 128 | ((c >> 12) & 63), 128 | ((c >> 6) & 63), 128 | (c & 63));\r\n                    }\r\n                }\r\n                else {\r\n                    if ((c & 64512) === 56320) {\r\n                        // Invalid low surrogate.\r\n                        b.push(239, 191, 189);\r\n                    }\r\n                    else {\r\n                        b.push(224 | (c >> 12), 128 | ((c >> 6) & 63), 128 | (c & 63));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return new Uint8Array(b);\r\n}\r\nfunction percentEncodedBytes_(value) {\r\n    var decoded;\r\n    try {\r\n        decoded = decodeURIComponent(value);\r\n    }\r\n    catch (e) {\r\n        throw invalidFormat(StringFormat.DATA_URL, 'Malformed data URL.');\r\n    }\r\n    return utf8Bytes_(decoded);\r\n}\r\nfunction base64Bytes_(format, value) {\r\n    switch (format) {\r\n        case StringFormat.BASE64: {\r\n            var hasMinus = value.indexOf('-') !== -1;\r\n            var hasUnder = value.indexOf('_') !== -1;\r\n            if (hasMinus || hasUnder) {\r\n                var invalidChar = hasMinus ? '-' : '_';\r\n                throw invalidFormat(format, \"Invalid character '\" +\r\n                    invalidChar +\r\n                    \"' found: is it base64url encoded?\");\r\n            }\r\n            break;\r\n        }\r\n        case StringFormat.BASE64URL: {\r\n            var hasPlus = value.indexOf('+') !== -1;\r\n            var hasSlash = value.indexOf('/') !== -1;\r\n            if (hasPlus || hasSlash) {\r\n                var invalidChar = hasPlus ? '+' : '/';\r\n                throw invalidFormat(format, \"Invalid character '\" + invalidChar + \"' found: is it base64 encoded?\");\r\n            }\r\n            value = value.replace(/-/g, '+').replace(/_/g, '/');\r\n            break;\r\n        }\r\n        // do nothing\r\n    }\r\n    var bytes;\r\n    try {\r\n        bytes = atob(value);\r\n    }\r\n    catch (e) {\r\n        throw invalidFormat(format, 'Invalid character found');\r\n    }\r\n    var array = new Uint8Array(bytes.length);\r\n    for (var i = 0; i < bytes.length; i++) {\r\n        array[i] = bytes.charCodeAt(i);\r\n    }\r\n    return array;\r\n}\r\n/**\r\n * @struct\r\n */\r\nvar DataURLParts = /** @class */ (function () {\r\n    function DataURLParts(dataURL) {\r\n        this.base64 = false;\r\n        this.contentType = null;\r\n        var matches = dataURL.match(/^data:([^,]+)?,/);\r\n        if (matches === null) {\r\n            throw invalidFormat(StringFormat.DATA_URL, \"Must be formatted 'data:[<mediatype>][;base64],<data>\");\r\n        }\r\n        var middle = matches[1] || null;\r\n        if (middle != null) {\r\n            this.base64 = endsWith(middle, ';base64');\r\n            this.contentType = this.base64\r\n                ? middle.substring(0, middle.length - ';base64'.length)\r\n                : middle;\r\n        }\r\n        this.rest = dataURL.substring(dataURL.indexOf(',') + 1);\r\n    }\r\n    return DataURLParts;\r\n}());\r\nfunction dataURLBytes_(dataUrl) {\r\n    var parts = new DataURLParts(dataUrl);\r\n    if (parts.base64) {\r\n        return base64Bytes_(StringFormat.BASE64, parts.rest);\r\n    }\r\n    else {\r\n        return percentEncodedBytes_(parts.rest);\r\n    }\r\n}\r\nfunction dataURLContentType_(dataUrl) {\r\n    var parts = new DataURLParts(dataUrl);\r\n    return parts.contentType;\r\n}\r\nfunction endsWith(s, end) {\r\n    var longEnough = s.length >= end.length;\r\n    if (!longEnough) {\r\n        return false;\r\n    }\r\n    return s.substring(s.length - end.length) === end;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar TaskEvent = {\r\n    /** Triggered whenever the task changes or progress is updated. */\r\n    STATE_CHANGED: 'state_changed'\r\n};\r\nvar InternalTaskState = {\r\n    RUNNING: 'running',\r\n    PAUSING: 'pausing',\r\n    PAUSED: 'paused',\r\n    SUCCESS: 'success',\r\n    CANCELING: 'canceling',\r\n    CANCELED: 'canceled',\r\n    ERROR: 'error'\r\n};\r\nvar TaskState = {\r\n    /** The task is currently transferring data. */\r\n    RUNNING: 'running',\r\n    /** The task was paused by the user. */\r\n    PAUSED: 'paused',\r\n    /** The task completed successfully. */\r\n    SUCCESS: 'success',\r\n    /** The task was canceled. */\r\n    CANCELED: 'canceled',\r\n    /** The task failed with an error. */\r\n    ERROR: 'error'\r\n};\r\nfunction taskStateFromInternalTaskState(state) {\r\n    switch (state) {\r\n        case InternalTaskState.RUNNING:\r\n        case InternalTaskState.PAUSING:\r\n        case InternalTaskState.CANCELING:\r\n            return TaskState.RUNNING;\r\n        case InternalTaskState.PAUSED:\r\n            return TaskState.PAUSED;\r\n        case InternalTaskState.SUCCESS:\r\n            return TaskState.SUCCESS;\r\n        case InternalTaskState.CANCELED:\r\n            return TaskState.CANCELED;\r\n        case InternalTaskState.ERROR:\r\n            return TaskState.ERROR;\r\n        default:\r\n            // TODO(andysoto): assert(false);\r\n            return TaskState.ERROR;\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @return False if the object is undefined or null, true otherwise.\r\n */\r\nfunction isDef(p) {\r\n    return p != null;\r\n}\r\nfunction isJustDef(p) {\r\n    return p !== void 0;\r\n}\r\n// eslint-disable-next-line @typescript-eslint/ban-types\r\nfunction isFunction(p) {\r\n    return typeof p === 'function';\r\n}\r\nfunction isObject(p) {\r\n    return typeof p === 'object';\r\n}\r\nfunction isNonNullObject(p) {\r\n    return isObject(p) && p !== null;\r\n}\r\nfunction isNonArrayObject(p) {\r\n    return isObject(p) && !Array.isArray(p);\r\n}\r\nfunction isString(p) {\r\n    return typeof p === 'string' || p instanceof String;\r\n}\r\nfunction isInteger(p) {\r\n    return isNumber(p) && Number.isInteger(p);\r\n}\r\nfunction isNumber(p) {\r\n    return typeof p === 'number' || p instanceof Number;\r\n}\r\nfunction isNativeBlob(p) {\r\n    return isNativeBlobDefined() && p instanceof Blob;\r\n}\r\nfunction isNativeBlobDefined() {\r\n    return typeof Blob !== 'undefined';\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @enum{number}\r\n */\r\nvar ErrorCode;\r\n(function (ErrorCode) {\r\n    ErrorCode[ErrorCode[\"NO_ERROR\"] = 0] = \"NO_ERROR\";\r\n    ErrorCode[ErrorCode[\"NETWORK_ERROR\"] = 1] = \"NETWORK_ERROR\";\r\n    ErrorCode[ErrorCode[\"ABORT\"] = 2] = \"ABORT\";\r\n})(ErrorCode || (ErrorCode = {}));\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * We use this instead of goog.net.XhrIo because goog.net.XhrIo is hyuuuuge and\r\n * doesn't work in React Native on Android.\r\n */\r\nvar NetworkXhrIo = /** @class */ (function () {\r\n    function NetworkXhrIo() {\r\n        var _this = this;\r\n        this.sent_ = false;\r\n        this.xhr_ = new XMLHttpRequest();\r\n        this.errorCode_ = ErrorCode.NO_ERROR;\r\n        this.sendPromise_ = new Promise(function (resolve) {\r\n            _this.xhr_.addEventListener('abort', function () {\r\n                _this.errorCode_ = ErrorCode.ABORT;\r\n                resolve(_this);\r\n            });\r\n            _this.xhr_.addEventListener('error', function () {\r\n                _this.errorCode_ = ErrorCode.NETWORK_ERROR;\r\n                resolve(_this);\r\n            });\r\n            _this.xhr_.addEventListener('load', function () {\r\n                resolve(_this);\r\n            });\r\n        });\r\n    }\r\n    /**\r\n     * @override\r\n     */\r\n    NetworkXhrIo.prototype.send = function (url, method, body, headers) {\r\n        if (this.sent_) {\r\n            throw internalError('cannot .send() more than once');\r\n        }\r\n        this.sent_ = true;\r\n        this.xhr_.open(method, url, true);\r\n        if (isDef(headers)) {\r\n            for (var key in headers) {\r\n                if (headers.hasOwnProperty(key)) {\r\n                    this.xhr_.setRequestHeader(key, headers[key].toString());\r\n                }\r\n            }\r\n        }\r\n        if (isDef(body)) {\r\n            this.xhr_.send(body);\r\n        }\r\n        else {\r\n            this.xhr_.send();\r\n        }\r\n        return this.sendPromise_;\r\n    };\r\n    /**\r\n     * @override\r\n     */\r\n    NetworkXhrIo.prototype.getErrorCode = function () {\r\n        if (!this.sent_) {\r\n            throw internalError('cannot .getErrorCode() before sending');\r\n        }\r\n        return this.errorCode_;\r\n    };\r\n    /**\r\n     * @override\r\n     */\r\n    NetworkXhrIo.prototype.getStatus = function () {\r\n        if (!this.sent_) {\r\n            throw internalError('cannot .getStatus() before sending');\r\n        }\r\n        try {\r\n            return this.xhr_.status;\r\n        }\r\n        catch (e) {\r\n            return -1;\r\n        }\r\n    };\r\n    /**\r\n     * @override\r\n     */\r\n    NetworkXhrIo.prototype.getResponseText = function () {\r\n        if (!this.sent_) {\r\n            throw internalError('cannot .getResponseText() before sending');\r\n        }\r\n        return this.xhr_.responseText;\r\n    };\r\n    /**\r\n     * Aborts the request.\r\n     * @override\r\n     */\r\n    NetworkXhrIo.prototype.abort = function () {\r\n        this.xhr_.abort();\r\n    };\r\n    /**\r\n     * @override\r\n     */\r\n    NetworkXhrIo.prototype.getResponseHeader = function (header) {\r\n        return this.xhr_.getResponseHeader(header);\r\n    };\r\n    /**\r\n     * @override\r\n     */\r\n    NetworkXhrIo.prototype.addUploadProgressListener = function (listener) {\r\n        if (isDef(this.xhr_.upload)) {\r\n            this.xhr_.upload.addEventListener('progress', listener);\r\n        }\r\n    };\r\n    /**\r\n     * @override\r\n     */\r\n    NetworkXhrIo.prototype.removeUploadProgressListener = function (listener) {\r\n        if (isDef(this.xhr_.upload)) {\r\n            this.xhr_.upload.removeEventListener('progress', listener);\r\n        }\r\n    };\r\n    return NetworkXhrIo;\r\n}());\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Factory-like class for creating XhrIo instances.\r\n */\r\nvar XhrIoPool = /** @class */ (function () {\r\n    function XhrIoPool() {\r\n    }\r\n    XhrIoPool.prototype.createXhrIo = function () {\r\n        return new NetworkXhrIo();\r\n    };\r\n    return XhrIoPool;\r\n}());\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction getBlobBuilder() {\r\n    if (typeof BlobBuilder !== 'undefined') {\r\n        return BlobBuilder;\r\n    }\r\n    else if (typeof WebKitBlobBuilder !== 'undefined') {\r\n        return WebKitBlobBuilder;\r\n    }\r\n    else {\r\n        return undefined;\r\n    }\r\n}\r\n/**\r\n * Concatenates one or more values together and converts them to a Blob.\r\n *\r\n * @param args The values that will make up the resulting blob.\r\n * @return The blob.\r\n */\r\nfunction getBlob() {\r\n    var args = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        args[_i] = arguments[_i];\r\n    }\r\n    var BlobBuilder = getBlobBuilder();\r\n    if (BlobBuilder !== undefined) {\r\n        var bb = new BlobBuilder();\r\n        for (var i = 0; i < args.length; i++) {\r\n            bb.append(args[i]);\r\n        }\r\n        return bb.getBlob();\r\n    }\r\n    else {\r\n        if (isNativeBlobDefined()) {\r\n            return new Blob(args);\r\n        }\r\n        else {\r\n            throw Error(\"This browser doesn't seem to support creating Blobs\");\r\n        }\r\n    }\r\n}\r\n/**\r\n * Slices the blob. The returned blob contains data from the start byte\r\n * (inclusive) till the end byte (exclusive). Negative indices cannot be used.\r\n *\r\n * @param blob The blob to be sliced.\r\n * @param start Index of the starting byte.\r\n * @param end Index of the ending byte.\r\n * @return The blob slice or null if not supported.\r\n */\r\nfunction sliceBlob(blob, start, end) {\r\n    if (blob.webkitSlice) {\r\n        return blob.webkitSlice(start, end);\r\n    }\r\n    else if (blob.mozSlice) {\r\n        return blob.mozSlice(start, end);\r\n    }\r\n    else if (blob.slice) {\r\n        return blob.slice(start, end);\r\n    }\r\n    return null;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @param opt_elideCopy If true, doesn't copy mutable input data\r\n *     (e.g. Uint8Arrays). Pass true only if you know the objects will not be\r\n *     modified after this blob's construction.\r\n */\r\nvar FbsBlob = /** @class */ (function () {\r\n    function FbsBlob(data, elideCopy) {\r\n        var size = 0;\r\n        var blobType = '';\r\n        if (isNativeBlob(data)) {\r\n            this.data_ = data;\r\n            size = data.size;\r\n            blobType = data.type;\r\n        }\r\n        else if (data instanceof ArrayBuffer) {\r\n            if (elideCopy) {\r\n                this.data_ = new Uint8Array(data);\r\n            }\r\n            else {\r\n                this.data_ = new Uint8Array(data.byteLength);\r\n                this.data_.set(new Uint8Array(data));\r\n            }\r\n            size = this.data_.length;\r\n        }\r\n        else if (data instanceof Uint8Array) {\r\n            if (elideCopy) {\r\n                this.data_ = data;\r\n            }\r\n            else {\r\n                this.data_ = new Uint8Array(data.length);\r\n                this.data_.set(data);\r\n            }\r\n            size = data.length;\r\n        }\r\n        this.size_ = size;\r\n        this.type_ = blobType;\r\n    }\r\n    FbsBlob.prototype.size = function () {\r\n        return this.size_;\r\n    };\r\n    FbsBlob.prototype.type = function () {\r\n        return this.type_;\r\n    };\r\n    FbsBlob.prototype.slice = function (startByte, endByte) {\r\n        if (isNativeBlob(this.data_)) {\r\n            var realBlob = this.data_;\r\n            var sliced = sliceBlob(realBlob, startByte, endByte);\r\n            if (sliced === null) {\r\n                return null;\r\n            }\r\n            return new FbsBlob(sliced);\r\n        }\r\n        else {\r\n            var slice = new Uint8Array(this.data_.buffer, startByte, endByte - startByte);\r\n            return new FbsBlob(slice, true);\r\n        }\r\n    };\r\n    FbsBlob.getBlob = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        if (isNativeBlobDefined()) {\r\n            var blobby = args.map(function (val) {\r\n                if (val instanceof FbsBlob) {\r\n                    return val.data_;\r\n                }\r\n                else {\r\n                    return val;\r\n                }\r\n            });\r\n            return new FbsBlob(getBlob.apply(null, blobby));\r\n        }\r\n        else {\r\n            var uint8Arrays = args.map(function (val) {\r\n                if (isString(val)) {\r\n                    return dataFromString(StringFormat.RAW, val).data;\r\n                }\r\n                else {\r\n                    // Blobs don't exist, so this has to be a Uint8Array.\r\n                    return val.data_;\r\n                }\r\n            });\r\n            var finalLength_1 = 0;\r\n            uint8Arrays.forEach(function (array) {\r\n                finalLength_1 += array.byteLength;\r\n            });\r\n            var merged_1 = new Uint8Array(finalLength_1);\r\n            var index_1 = 0;\r\n            uint8Arrays.forEach(function (array) {\r\n                for (var i = 0; i < array.length; i++) {\r\n                    merged_1[index_1++] = array[i];\r\n                }\r\n            });\r\n            return new FbsBlob(merged_1, true);\r\n        }\r\n    };\r\n    FbsBlob.prototype.uploadData = function () {\r\n        return this.data_;\r\n    };\r\n    return FbsBlob;\r\n}());\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @struct\r\n */\r\nvar Location = /** @class */ (function () {\r\n    function Location(bucket, path) {\r\n        this.bucket = bucket;\r\n        this.path_ = path;\r\n    }\r\n    Object.defineProperty(Location.prototype, \"path\", {\r\n        get: function () {\r\n            return this.path_;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Location.prototype, \"isRoot\", {\r\n        get: function () {\r\n            return this.path.length === 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Location.prototype.fullServerUrl = function () {\r\n        var encode = encodeURIComponent;\r\n        return '/b/' + encode(this.bucket) + '/o/' + encode(this.path);\r\n    };\r\n    Location.prototype.bucketOnlyServerUrl = function () {\r\n        var encode = encodeURIComponent;\r\n        return '/b/' + encode(this.bucket) + '/o';\r\n    };\r\n    Location.makeFromBucketSpec = function (bucketString) {\r\n        var bucketLocation;\r\n        try {\r\n            bucketLocation = Location.makeFromUrl(bucketString);\r\n        }\r\n        catch (e) {\r\n            // Not valid URL, use as-is. This lets you put bare bucket names in\r\n            // config.\r\n            return new Location(bucketString, '');\r\n        }\r\n        if (bucketLocation.path === '') {\r\n            return bucketLocation;\r\n        }\r\n        else {\r\n            throw invalidDefaultBucket(bucketString);\r\n        }\r\n    };\r\n    Location.makeFromUrl = function (url) {\r\n        var location = null;\r\n        var bucketDomain = '([A-Za-z0-9.\\\\-_]+)';\r\n        function gsModify(loc) {\r\n            if (loc.path.charAt(loc.path.length - 1) === '/') {\r\n                loc.path_ = loc.path_.slice(0, -1);\r\n            }\r\n        }\r\n        var gsPath = '(/(.*))?$';\r\n        var gsRegex = new RegExp('^gs://' + bucketDomain + gsPath, 'i');\r\n        var gsIndices = { bucket: 1, path: 3 };\r\n        function httpModify(loc) {\r\n            loc.path_ = decodeURIComponent(loc.path);\r\n        }\r\n        var version = 'v[A-Za-z0-9_]+';\r\n        var firebaseStorageHost = DEFAULT_HOST.replace(/[.]/g, '\\\\.');\r\n        var firebaseStoragePath = '(/([^?#]*).*)?$';\r\n        var firebaseStorageRegExp = new RegExp(\"^https?://\" + firebaseStorageHost + \"/\" + version + \"/b/\" + bucketDomain + \"/o\" + firebaseStoragePath, 'i');\r\n        var firebaseStorageIndices = { bucket: 1, path: 3 };\r\n        var cloudStorageHost = '(?:storage.googleapis.com|storage.cloud.google.com)';\r\n        var cloudStoragePath = '([^?#]*)';\r\n        var cloudStorageRegExp = new RegExp(\"^https?://\" + cloudStorageHost + \"/\" + bucketDomain + \"/\" + cloudStoragePath, 'i');\r\n        var cloudStorageIndices = { bucket: 1, path: 2 };\r\n        var groups = [\r\n            { regex: gsRegex, indices: gsIndices, postModify: gsModify },\r\n            {\r\n                regex: firebaseStorageRegExp,\r\n                indices: firebaseStorageIndices,\r\n                postModify: httpModify\r\n            },\r\n            {\r\n                regex: cloudStorageRegExp,\r\n                indices: cloudStorageIndices,\r\n                postModify: httpModify\r\n            }\r\n        ];\r\n        for (var i = 0; i < groups.length; i++) {\r\n            var group = groups[i];\r\n            var captures = group.regex.exec(url);\r\n            if (captures) {\r\n                var bucketValue = captures[group.indices.bucket];\r\n                var pathValue = captures[group.indices.path];\r\n                if (!pathValue) {\r\n                    pathValue = '';\r\n                }\r\n                location = new Location(bucketValue, pathValue);\r\n                group.postModify(location);\r\n                break;\r\n            }\r\n        }\r\n        if (location == null) {\r\n            throw invalidUrl(url);\r\n        }\r\n        return location;\r\n    };\r\n    return Location;\r\n}());\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns the Object resulting from parsing the given JSON, or null if the\r\n * given string does not represent a JSON object.\r\n */\r\nfunction jsonObjectOrNull(s) {\r\n    var obj;\r\n    try {\r\n        obj = JSON.parse(s);\r\n    }\r\n    catch (e) {\r\n        return null;\r\n    }\r\n    if (isNonArrayObject(obj)) {\r\n        return obj;\r\n    }\r\n    else {\r\n        return null;\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @fileoverview Contains helper methods for manipulating paths.\r\n */\r\n/**\r\n * @return Null if the path is already at the root.\r\n */\r\nfunction parent(path) {\r\n    if (path.length === 0) {\r\n        return null;\r\n    }\r\n    var index = path.lastIndexOf('/');\r\n    if (index === -1) {\r\n        return '';\r\n    }\r\n    var newPath = path.slice(0, index);\r\n    return newPath;\r\n}\r\nfunction child(path, childPath) {\r\n    var canonicalChildPath = childPath\r\n        .split('/')\r\n        .filter(function (component) { return component.length > 0; })\r\n        .join('/');\r\n    if (path.length === 0) {\r\n        return canonicalChildPath;\r\n    }\r\n    else {\r\n        return path + '/' + canonicalChildPath;\r\n    }\r\n}\r\n/**\r\n * Returns the last component of a path.\r\n * '/foo/bar' -> 'bar'\r\n * '/foo/bar/baz/' -> 'baz/'\r\n * '/a' -> 'a'\r\n */\r\nfunction lastComponent(path) {\r\n    var index = path.lastIndexOf('/', path.length - 2);\r\n    if (index === -1) {\r\n        return path;\r\n    }\r\n    else {\r\n        return path.slice(index + 1);\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction makeUrl(urlPart) {\r\n    return \"https://\" + DEFAULT_HOST + \"/v0\" + urlPart;\r\n}\r\nfunction makeQueryString(params) {\r\n    var encode = encodeURIComponent;\r\n    var queryPart = '?';\r\n    for (var key in params) {\r\n        if (params.hasOwnProperty(key)) {\r\n            // @ts-ignore TODO: remove once typescript is upgraded to 3.5.x\r\n            var nextPart = encode(key) + '=' + encode(params[key]);\r\n            queryPart = queryPart + nextPart + '&';\r\n        }\r\n    }\r\n    // Chop off the extra '&' or '?' on the end\r\n    queryPart = queryPart.slice(0, -1);\r\n    return queryPart;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction noXform_(metadata, value) {\r\n    return value;\r\n}\r\n/**\r\n * @struct\r\n */\r\nvar Mapping = /** @class */ (function () {\r\n    function Mapping(server, local, writable, xform) {\r\n        this.server = server;\r\n        this.local = local || server;\r\n        this.writable = !!writable;\r\n        this.xform = xform || noXform_;\r\n    }\r\n    return Mapping;\r\n}());\r\nvar mappings_ = null;\r\nfunction xformPath(fullPath) {\r\n    if (!isString(fullPath) || fullPath.length < 2) {\r\n        return fullPath;\r\n    }\r\n    else {\r\n        return lastComponent(fullPath);\r\n    }\r\n}\r\nfunction getMappings() {\r\n    if (mappings_) {\r\n        return mappings_;\r\n    }\r\n    var mappings = [];\r\n    mappings.push(new Mapping('bucket'));\r\n    mappings.push(new Mapping('generation'));\r\n    mappings.push(new Mapping('metageneration'));\r\n    mappings.push(new Mapping('name', 'fullPath', true));\r\n    function mappingsXformPath(_metadata, fullPath) {\r\n        return xformPath(fullPath);\r\n    }\r\n    var nameMapping = new Mapping('name');\r\n    nameMapping.xform = mappingsXformPath;\r\n    mappings.push(nameMapping);\r\n    /**\r\n     * Coerces the second param to a number, if it is defined.\r\n     */\r\n    function xformSize(_metadata, size) {\r\n        if (isDef(size)) {\r\n            return Number(size);\r\n        }\r\n        else {\r\n            return size;\r\n        }\r\n    }\r\n    var sizeMapping = new Mapping('size');\r\n    sizeMapping.xform = xformSize;\r\n    mappings.push(sizeMapping);\r\n    mappings.push(new Mapping('timeCreated'));\r\n    mappings.push(new Mapping('updated'));\r\n    mappings.push(new Mapping('md5Hash', null, true));\r\n    mappings.push(new Mapping('cacheControl', null, true));\r\n    mappings.push(new Mapping('contentDisposition', null, true));\r\n    mappings.push(new Mapping('contentEncoding', null, true));\r\n    mappings.push(new Mapping('contentLanguage', null, true));\r\n    mappings.push(new Mapping('contentType', null, true));\r\n    mappings.push(new Mapping('metadata', 'customMetadata', true));\r\n    mappings_ = mappings;\r\n    return mappings_;\r\n}\r\nfunction addRef(metadata, service) {\r\n    function generateRef() {\r\n        var bucket = metadata['bucket'];\r\n        var path = metadata['fullPath'];\r\n        var loc = new Location(bucket, path);\r\n        return service.makeStorageReference(loc);\r\n    }\r\n    Object.defineProperty(metadata, 'ref', { get: generateRef });\r\n}\r\nfunction fromResource(service, resource, mappings) {\r\n    var metadata = {};\r\n    metadata['type'] = 'file';\r\n    var len = mappings.length;\r\n    for (var i = 0; i < len; i++) {\r\n        var mapping = mappings[i];\r\n        metadata[mapping.local] = mapping.xform(metadata, resource[mapping.server]);\r\n    }\r\n    addRef(metadata, service);\r\n    return metadata;\r\n}\r\nfunction fromResourceString(service, resourceString, mappings) {\r\n    var obj = jsonObjectOrNull(resourceString);\r\n    if (obj === null) {\r\n        return null;\r\n    }\r\n    var resource = obj;\r\n    return fromResource(service, resource, mappings);\r\n}\r\nfunction downloadUrlFromResourceString(metadata, resourceString) {\r\n    var obj = jsonObjectOrNull(resourceString);\r\n    if (obj === null) {\r\n        return null;\r\n    }\r\n    if (!isString(obj['downloadTokens'])) {\r\n        // This can happen if objects are uploaded through GCS and retrieved\r\n        // through list, so we don't want to throw an Error.\r\n        return null;\r\n    }\r\n    var tokens = obj['downloadTokens'];\r\n    if (tokens.length === 0) {\r\n        return null;\r\n    }\r\n    var encode = encodeURIComponent;\r\n    var tokensList = tokens.split(',');\r\n    var urls = tokensList.map(function (token) {\r\n        var bucket = metadata['bucket'];\r\n        var path = metadata['fullPath'];\r\n        var urlPart = '/b/' + encode(bucket) + '/o/' + encode(path);\r\n        var base = makeUrl(urlPart);\r\n        var queryString = makeQueryString({\r\n            alt: 'media',\r\n            token: token\r\n        });\r\n        return base + queryString;\r\n    });\r\n    return urls[0];\r\n}\r\nfunction toResourceString(metadata, mappings) {\r\n    var resource = {};\r\n    var len = mappings.length;\r\n    for (var i = 0; i < len; i++) {\r\n        var mapping = mappings[i];\r\n        if (mapping.writable) {\r\n            resource[mapping.server] = metadata[mapping.local];\r\n        }\r\n    }\r\n    return JSON.stringify(resource);\r\n}\r\nfunction metadataValidator(p) {\r\n    if (!isObject(p) || !p) {\r\n        throw 'Expected Metadata object.';\r\n    }\r\n    for (var key in p) {\r\n        if (p.hasOwnProperty(key)) {\r\n            var val = p[key];\r\n            if (key === 'customMetadata') {\r\n                if (!isObject(val)) {\r\n                    throw 'Expected object for \\'customMetadata\\' mapping.';\r\n                }\r\n            }\r\n            else {\r\n                if (isNonNullObject(val)) {\r\n                    throw \"Mapping for '\" + key + \"' cannot be an object.\";\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nvar MAX_RESULTS_KEY = 'maxResults';\r\nvar MAX_MAX_RESULTS = 1000;\r\nvar PAGE_TOKEN_KEY = 'pageToken';\r\nvar PREFIXES_KEY = 'prefixes';\r\nvar ITEMS_KEY = 'items';\r\nfunction fromBackendResponse(service, bucket, resource) {\r\n    var listResult = {\r\n        prefixes: [],\r\n        items: [],\r\n        nextPageToken: resource['nextPageToken']\r\n    };\r\n    if (resource[PREFIXES_KEY]) {\r\n        for (var _i = 0, _a = resource[PREFIXES_KEY]; _i < _a.length; _i++) {\r\n            var path = _a[_i];\r\n            var pathWithoutTrailingSlash = path.replace(/\\/$/, '');\r\n            var reference = service.makeStorageReference(new Location(bucket, pathWithoutTrailingSlash));\r\n            listResult.prefixes.push(reference);\r\n        }\r\n    }\r\n    if (resource[ITEMS_KEY]) {\r\n        for (var _b = 0, _c = resource[ITEMS_KEY]; _b < _c.length; _b++) {\r\n            var item = _c[_b];\r\n            var reference = service.makeStorageReference(new Location(bucket, item['name']));\r\n            listResult.items.push(reference);\r\n        }\r\n    }\r\n    return listResult;\r\n}\r\nfunction fromResponseString(service, bucket, resourceString) {\r\n    var obj = jsonObjectOrNull(resourceString);\r\n    if (obj === null) {\r\n        return null;\r\n    }\r\n    var resource = obj;\r\n    return fromBackendResponse(service, bucket, resource);\r\n}\r\nfunction listOptionsValidator(p) {\r\n    if (!isObject(p) || !p) {\r\n        throw 'Expected ListOptions object.';\r\n    }\r\n    for (var key in p) {\r\n        if (key === MAX_RESULTS_KEY) {\r\n            if (!isInteger(p[MAX_RESULTS_KEY]) ||\r\n                p[MAX_RESULTS_KEY] <= 0) {\r\n                throw 'Expected maxResults to be a positive number.';\r\n            }\r\n            if (p[MAX_RESULTS_KEY] > 1000) {\r\n                throw \"Expected maxResults to be less than or equal to \" + MAX_MAX_RESULTS + \".\";\r\n            }\r\n        }\r\n        else if (key === PAGE_TOKEN_KEY) {\r\n            if (p[PAGE_TOKEN_KEY] && !isString(p[PAGE_TOKEN_KEY])) {\r\n                throw 'Expected pageToken to be string.';\r\n            }\r\n        }\r\n        else {\r\n            throw 'Unknown option: ' + key;\r\n        }\r\n    }\r\n}\n\nvar RequestInfo = /** @class */ (function () {\r\n    function RequestInfo(url, method, \r\n    /**\r\n     * Returns the value with which to resolve the request's promise. Only called\r\n     * if the request is successful. Throw from this function to reject the\r\n     * returned Request's promise with the thrown error.\r\n     * Note: The XhrIo passed to this function may be reused after this callback\r\n     * returns. Do not keep a reference to it in any way.\r\n     */\r\n    handler, timeout) {\r\n        this.url = url;\r\n        this.method = method;\r\n        this.handler = handler;\r\n        this.timeout = timeout;\r\n        this.urlParams = {};\r\n        this.headers = {};\r\n        this.body = null;\r\n        this.errorHandler = null;\r\n        /**\r\n         * Called with the current number of bytes uploaded and total size (-1 if not\r\n         * computable) of the request body (i.e. used to report upload progress).\r\n         */\r\n        this.progressCallback = null;\r\n        this.successCodes = [200];\r\n        this.additionalRetryCodes = [];\r\n    }\r\n    return RequestInfo;\r\n}());\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Throws the UNKNOWN FirebaseStorageError if cndn is false.\r\n */\r\nfunction handlerCheck(cndn) {\r\n    if (!cndn) {\r\n        throw unknown();\r\n    }\r\n}\r\nfunction metadataHandler(service, mappings) {\r\n    function handler(xhr, text) {\r\n        var metadata = fromResourceString(service, text, mappings);\r\n        handlerCheck(metadata !== null);\r\n        return metadata;\r\n    }\r\n    return handler;\r\n}\r\nfunction listHandler(service, bucket) {\r\n    function handler(xhr, text) {\r\n        var listResult = fromResponseString(service, bucket, text);\r\n        handlerCheck(listResult !== null);\r\n        return listResult;\r\n    }\r\n    return handler;\r\n}\r\nfunction downloadUrlHandler(service, mappings) {\r\n    function handler(xhr, text) {\r\n        var metadata = fromResourceString(service, text, mappings);\r\n        handlerCheck(metadata !== null);\r\n        return downloadUrlFromResourceString(metadata, text);\r\n    }\r\n    return handler;\r\n}\r\nfunction sharedErrorHandler(location) {\r\n    function errorHandler(xhr, err) {\r\n        var newErr;\r\n        if (xhr.getStatus() === 401) {\r\n            newErr = unauthenticated();\r\n        }\r\n        else {\r\n            if (xhr.getStatus() === 402) {\r\n                newErr = quotaExceeded(location.bucket);\r\n            }\r\n            else {\r\n                if (xhr.getStatus() === 403) {\r\n                    newErr = unauthorized(location.path);\r\n                }\r\n                else {\r\n                    newErr = err;\r\n                }\r\n            }\r\n        }\r\n        newErr.setServerResponseProp(err.serverResponseProp());\r\n        return newErr;\r\n    }\r\n    return errorHandler;\r\n}\r\nfunction objectErrorHandler(location) {\r\n    var shared = sharedErrorHandler(location);\r\n    function errorHandler(xhr, err) {\r\n        var newErr = shared(xhr, err);\r\n        if (xhr.getStatus() === 404) {\r\n            newErr = objectNotFound(location.path);\r\n        }\r\n        newErr.setServerResponseProp(err.serverResponseProp());\r\n        return newErr;\r\n    }\r\n    return errorHandler;\r\n}\r\nfunction getMetadata(service, location, mappings) {\r\n    var urlPart = location.fullServerUrl();\r\n    var url = makeUrl(urlPart);\r\n    var method = 'GET';\r\n    var timeout = service.maxOperationRetryTime;\r\n    var requestInfo = new RequestInfo(url, method, metadataHandler(service, mappings), timeout);\r\n    requestInfo.errorHandler = objectErrorHandler(location);\r\n    return requestInfo;\r\n}\r\nfunction list(service, location, delimiter, pageToken, maxResults) {\r\n    var urlParams = {};\r\n    if (location.isRoot) {\r\n        urlParams['prefix'] = '';\r\n    }\r\n    else {\r\n        urlParams['prefix'] = location.path + '/';\r\n    }\r\n    if (delimiter && delimiter.length > 0) {\r\n        urlParams['delimiter'] = delimiter;\r\n    }\r\n    if (pageToken) {\r\n        urlParams['pageToken'] = pageToken;\r\n    }\r\n    if (maxResults) {\r\n        urlParams['maxResults'] = maxResults;\r\n    }\r\n    var urlPart = location.bucketOnlyServerUrl();\r\n    var url = makeUrl(urlPart);\r\n    var method = 'GET';\r\n    var timeout = service.maxOperationRetryTime;\r\n    var requestInfo = new RequestInfo(url, method, listHandler(service, location.bucket), timeout);\r\n    requestInfo.urlParams = urlParams;\r\n    requestInfo.errorHandler = sharedErrorHandler(location);\r\n    return requestInfo;\r\n}\r\nfunction getDownloadUrl(service, location, mappings) {\r\n    var urlPart = location.fullServerUrl();\r\n    var url = makeUrl(urlPart);\r\n    var method = 'GET';\r\n    var timeout = service.maxOperationRetryTime;\r\n    var requestInfo = new RequestInfo(url, method, downloadUrlHandler(service, mappings), timeout);\r\n    requestInfo.errorHandler = objectErrorHandler(location);\r\n    return requestInfo;\r\n}\r\nfunction updateMetadata(service, location, metadata, mappings) {\r\n    var urlPart = location.fullServerUrl();\r\n    var url = makeUrl(urlPart);\r\n    var method = 'PATCH';\r\n    var body = toResourceString(metadata, mappings);\r\n    var headers = { 'Content-Type': 'application/json; charset=utf-8' };\r\n    var timeout = service.maxOperationRetryTime;\r\n    var requestInfo = new RequestInfo(url, method, metadataHandler(service, mappings), timeout);\r\n    requestInfo.headers = headers;\r\n    requestInfo.body = body;\r\n    requestInfo.errorHandler = objectErrorHandler(location);\r\n    return requestInfo;\r\n}\r\nfunction deleteObject(service, location) {\r\n    var urlPart = location.fullServerUrl();\r\n    var url = makeUrl(urlPart);\r\n    var method = 'DELETE';\r\n    var timeout = service.maxOperationRetryTime;\r\n    function handler(_xhr, _text) { }\r\n    var requestInfo = new RequestInfo(url, method, handler, timeout);\r\n    requestInfo.successCodes = [200, 204];\r\n    requestInfo.errorHandler = objectErrorHandler(location);\r\n    return requestInfo;\r\n}\r\nfunction determineContentType_(metadata, blob) {\r\n    return ((metadata && metadata['contentType']) ||\r\n        (blob && blob.type()) ||\r\n        'application/octet-stream');\r\n}\r\nfunction metadataForUpload_(location, blob, metadata) {\r\n    var metadataClone = Object.assign({}, metadata);\r\n    metadataClone['fullPath'] = location.path;\r\n    metadataClone['size'] = blob.size();\r\n    if (!metadataClone['contentType']) {\r\n        metadataClone['contentType'] = determineContentType_(null, blob);\r\n    }\r\n    return metadataClone;\r\n}\r\nfunction multipartUpload(service, location, mappings, blob, metadata) {\r\n    var urlPart = location.bucketOnlyServerUrl();\r\n    var headers = {\r\n        'X-Goog-Upload-Protocol': 'multipart'\r\n    };\r\n    function genBoundary() {\r\n        var str = '';\r\n        for (var i = 0; i < 2; i++) {\r\n            str = str + Math.random().toString().slice(2);\r\n        }\r\n        return str;\r\n    }\r\n    var boundary = genBoundary();\r\n    headers['Content-Type'] = 'multipart/related; boundary=' + boundary;\r\n    var metadata_ = metadataForUpload_(location, blob, metadata);\r\n    var metadataString = toResourceString(metadata_, mappings);\r\n    var preBlobPart = '--' +\r\n        boundary +\r\n        '\\r\\n' +\r\n        'Content-Type: application/json; charset=utf-8\\r\\n\\r\\n' +\r\n        metadataString +\r\n        '\\r\\n--' +\r\n        boundary +\r\n        '\\r\\n' +\r\n        'Content-Type: ' +\r\n        metadata_['contentType'] +\r\n        '\\r\\n\\r\\n';\r\n    var postBlobPart = '\\r\\n--' + boundary + '--';\r\n    var body = FbsBlob.getBlob(preBlobPart, blob, postBlobPart);\r\n    if (body === null) {\r\n        throw cannotSliceBlob();\r\n    }\r\n    var urlParams = { name: metadata_['fullPath'] };\r\n    var url = makeUrl(urlPart);\r\n    var method = 'POST';\r\n    var timeout = service.maxUploadRetryTime;\r\n    var requestInfo = new RequestInfo(url, method, metadataHandler(service, mappings), timeout);\r\n    requestInfo.urlParams = urlParams;\r\n    requestInfo.headers = headers;\r\n    requestInfo.body = body.uploadData();\r\n    requestInfo.errorHandler = sharedErrorHandler(location);\r\n    return requestInfo;\r\n}\r\n/**\r\n * @param current The number of bytes that have been uploaded so far.\r\n * @param total The total number of bytes in the upload.\r\n * @param opt_finalized True if the server has finished the upload.\r\n * @param opt_metadata The upload metadata, should\r\n *     only be passed if opt_finalized is true.\r\n * @struct\r\n */\r\nvar ResumableUploadStatus = /** @class */ (function () {\r\n    function ResumableUploadStatus(current, total, finalized, metadata) {\r\n        this.current = current;\r\n        this.total = total;\r\n        this.finalized = !!finalized;\r\n        this.metadata = metadata || null;\r\n    }\r\n    return ResumableUploadStatus;\r\n}());\r\nfunction checkResumeHeader_(xhr, allowed) {\r\n    var status = null;\r\n    try {\r\n        status = xhr.getResponseHeader('X-Goog-Upload-Status');\r\n    }\r\n    catch (e) {\r\n        handlerCheck(false);\r\n    }\r\n    var allowedStatus = allowed || ['active'];\r\n    handlerCheck(!!status && allowedStatus.indexOf(status) !== -1);\r\n    return status;\r\n}\r\nfunction createResumableUpload(service, location, mappings, blob, metadata) {\r\n    var urlPart = location.bucketOnlyServerUrl();\r\n    var metadataForUpload = metadataForUpload_(location, blob, metadata);\r\n    var urlParams = { name: metadataForUpload['fullPath'] };\r\n    var url = makeUrl(urlPart);\r\n    var method = 'POST';\r\n    var headers = {\r\n        'X-Goog-Upload-Protocol': 'resumable',\r\n        'X-Goog-Upload-Command': 'start',\r\n        'X-Goog-Upload-Header-Content-Length': blob.size(),\r\n        'X-Goog-Upload-Header-Content-Type': metadataForUpload['contentType'],\r\n        'Content-Type': 'application/json; charset=utf-8'\r\n    };\r\n    var body = toResourceString(metadataForUpload, mappings);\r\n    var timeout = service.maxUploadRetryTime;\r\n    function handler(xhr) {\r\n        checkResumeHeader_(xhr);\r\n        var url;\r\n        try {\r\n            url = xhr.getResponseHeader('X-Goog-Upload-URL');\r\n        }\r\n        catch (e) {\r\n            handlerCheck(false);\r\n        }\r\n        handlerCheck(isString(url));\r\n        return url;\r\n    }\r\n    var requestInfo = new RequestInfo(url, method, handler, timeout);\r\n    requestInfo.urlParams = urlParams;\r\n    requestInfo.headers = headers;\r\n    requestInfo.body = body;\r\n    requestInfo.errorHandler = sharedErrorHandler(location);\r\n    return requestInfo;\r\n}\r\n/**\r\n * @param url From a call to fbs.requests.createResumableUpload.\r\n */\r\nfunction getResumableUploadStatus(service, location, url, blob) {\r\n    var headers = { 'X-Goog-Upload-Command': 'query' };\r\n    function handler(xhr) {\r\n        var status = checkResumeHeader_(xhr, ['active', 'final']);\r\n        var sizeString = null;\r\n        try {\r\n            sizeString = xhr.getResponseHeader('X-Goog-Upload-Size-Received');\r\n        }\r\n        catch (e) {\r\n            handlerCheck(false);\r\n        }\r\n        if (!sizeString) {\r\n            // null or empty string\r\n            handlerCheck(false);\r\n        }\r\n        var size = Number(sizeString);\r\n        handlerCheck(!isNaN(size));\r\n        return new ResumableUploadStatus(size, blob.size(), status === 'final');\r\n    }\r\n    var method = 'POST';\r\n    var timeout = service.maxUploadRetryTime;\r\n    var requestInfo = new RequestInfo(url, method, handler, timeout);\r\n    requestInfo.headers = headers;\r\n    requestInfo.errorHandler = sharedErrorHandler(location);\r\n    return requestInfo;\r\n}\r\n/**\r\n * Any uploads via the resumable upload API must transfer a number of bytes\r\n * that is a multiple of this number.\r\n */\r\nvar resumableUploadChunkSize = 256 * 1024;\r\n/**\r\n * @param url From a call to fbs.requests.createResumableUpload.\r\n * @param chunkSize Number of bytes to upload.\r\n * @param status The previous status.\r\n *     If not passed or null, we start from the beginning.\r\n * @throws fbs.Error If the upload is already complete, the passed in status\r\n *     has a final size inconsistent with the blob, or the blob cannot be sliced\r\n *     for upload.\r\n */\r\nfunction continueResumableUpload(location, service, url, blob, chunkSize, mappings, status, progressCallback) {\r\n    // TODO(andysoto): standardize on internal asserts\r\n    // assert(!(opt_status && opt_status.finalized));\r\n    var status_ = new ResumableUploadStatus(0, 0);\r\n    if (status) {\r\n        status_.current = status.current;\r\n        status_.total = status.total;\r\n    }\r\n    else {\r\n        status_.current = 0;\r\n        status_.total = blob.size();\r\n    }\r\n    if (blob.size() !== status_.total) {\r\n        throw serverFileWrongSize();\r\n    }\r\n    var bytesLeft = status_.total - status_.current;\r\n    var bytesToUpload = bytesLeft;\r\n    if (chunkSize > 0) {\r\n        bytesToUpload = Math.min(bytesToUpload, chunkSize);\r\n    }\r\n    var startByte = status_.current;\r\n    var endByte = startByte + bytesToUpload;\r\n    var uploadCommand = bytesToUpload === bytesLeft ? 'upload, finalize' : 'upload';\r\n    var headers = {\r\n        'X-Goog-Upload-Command': uploadCommand,\r\n        'X-Goog-Upload-Offset': status_.current\r\n    };\r\n    var body = blob.slice(startByte, endByte);\r\n    if (body === null) {\r\n        throw cannotSliceBlob();\r\n    }\r\n    function handler(xhr, text) {\r\n        // TODO(andysoto): Verify the MD5 of each uploaded range:\r\n        // the 'x-range-md5' header comes back with status code 308 responses.\r\n        // We'll only be able to bail out though, because you can't re-upload a\r\n        // range that you previously uploaded.\r\n        var uploadStatus = checkResumeHeader_(xhr, ['active', 'final']);\r\n        var newCurrent = status_.current + bytesToUpload;\r\n        var size = blob.size();\r\n        var metadata;\r\n        if (uploadStatus === 'final') {\r\n            metadata = metadataHandler(service, mappings)(xhr, text);\r\n        }\r\n        else {\r\n            metadata = null;\r\n        }\r\n        return new ResumableUploadStatus(newCurrent, size, uploadStatus === 'final', metadata);\r\n    }\r\n    var method = 'POST';\r\n    var timeout = service.maxUploadRetryTime;\r\n    var requestInfo = new RequestInfo(url, method, handler, timeout);\r\n    requestInfo.headers = headers;\r\n    requestInfo.body = body.uploadData();\r\n    requestInfo.progressCallback = progressCallback || null;\r\n    requestInfo.errorHandler = sharedErrorHandler(location);\r\n    return requestInfo;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @struct\r\n */\r\nvar Observer = /** @class */ (function () {\r\n    function Observer(nextOrObserver, error, complete) {\r\n        var asFunctions = isFunction(nextOrObserver) ||\r\n            isDef(error) ||\r\n            isDef(complete);\r\n        if (asFunctions) {\r\n            this.next = nextOrObserver;\r\n            this.error = error || null;\r\n            this.complete = complete || null;\r\n        }\r\n        else {\r\n            var observer = nextOrObserver;\r\n            this.next = observer.next || null;\r\n            this.error = observer.error || null;\r\n            this.complete = observer.complete || null;\r\n        }\r\n    }\r\n    return Observer;\r\n}());\n\nvar UploadTaskSnapshot = /** @class */ (function () {\r\n    function UploadTaskSnapshot(bytesTransferred, totalBytes, state, metadata, task, ref) {\r\n        this.bytesTransferred = bytesTransferred;\r\n        this.totalBytes = totalBytes;\r\n        this.state = state;\r\n        this.metadata = metadata;\r\n        this.task = task;\r\n        this.ref = ref;\r\n    }\r\n    return UploadTaskSnapshot;\r\n}());\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @param name Name of the function.\r\n * @param specs Argument specs.\r\n * @param passed The actual arguments passed to the function.\r\n * @throws {fbs.Error} If the arguments are invalid.\r\n */\r\nfunction validate(name, specs, passed) {\r\n    var minArgs = specs.length;\r\n    var maxArgs = specs.length;\r\n    for (var i = 0; i < specs.length; i++) {\r\n        if (specs[i].optional) {\r\n            minArgs = i;\r\n            break;\r\n        }\r\n    }\r\n    var validLength = minArgs <= passed.length && passed.length <= maxArgs;\r\n    if (!validLength) {\r\n        throw invalidArgumentCount(minArgs, maxArgs, name, passed.length);\r\n    }\r\n    for (var i = 0; i < passed.length; i++) {\r\n        try {\r\n            specs[i].validator(passed[i]);\r\n        }\r\n        catch (e) {\r\n            if (e instanceof Error) {\r\n                throw invalidArgument(i, name, e.message);\r\n            }\r\n            else {\r\n                throw invalidArgument(i, name, e);\r\n            }\r\n        }\r\n    }\r\n}\r\n/**\r\n * @struct\r\n */\r\nvar ArgSpec = /** @class */ (function () {\r\n    function ArgSpec(validator, optional) {\r\n        var self = this;\r\n        this.validator = function (p) {\r\n            if (self.optional && !isJustDef(p)) {\r\n                return;\r\n            }\r\n            validator(p);\r\n        };\r\n        this.optional = !!optional;\r\n    }\r\n    return ArgSpec;\r\n}());\r\nfunction and_(v1, v2) {\r\n    return function (p) {\r\n        v1(p);\r\n        v2(p);\r\n    };\r\n}\r\nfunction stringSpec(validator, optional) {\r\n    function stringValidator(p) {\r\n        if (!isString(p)) {\r\n            throw 'Expected string.';\r\n        }\r\n    }\r\n    var chainedValidator;\r\n    if (validator) {\r\n        chainedValidator = and_(stringValidator, validator);\r\n    }\r\n    else {\r\n        chainedValidator = stringValidator;\r\n    }\r\n    return new ArgSpec(chainedValidator, optional);\r\n}\r\nfunction uploadDataSpec() {\r\n    function validator(p) {\r\n        var valid = p instanceof Uint8Array ||\r\n            p instanceof ArrayBuffer ||\r\n            (isNativeBlobDefined() && p instanceof Blob);\r\n        if (!valid) {\r\n            throw 'Expected Blob or File.';\r\n        }\r\n    }\r\n    return new ArgSpec(validator);\r\n}\r\nfunction metadataSpec(optional) {\r\n    return new ArgSpec(metadataValidator, optional);\r\n}\r\nfunction listOptionSpec(optional) {\r\n    return new ArgSpec(listOptionsValidator, optional);\r\n}\r\nfunction nonNegativeNumberSpec() {\r\n    function validator(p) {\r\n        var valid = isNumber(p) && p >= 0;\r\n        if (!valid) {\r\n            throw 'Expected a number 0 or greater.';\r\n        }\r\n    }\r\n    return new ArgSpec(validator);\r\n}\r\nfunction looseObjectSpec(validator, optional) {\r\n    function isLooseObjectValidator(p) {\r\n        var isLooseObject = p === null || (isDef(p) && p instanceof Object);\r\n        if (!isLooseObject) {\r\n            throw 'Expected an Object.';\r\n        }\r\n        if (validator !== undefined && validator !== null) {\r\n            validator(p);\r\n        }\r\n    }\r\n    return new ArgSpec(isLooseObjectValidator, optional);\r\n}\r\nfunction nullFunctionSpec(optional) {\r\n    function validator(p) {\r\n        var valid = p === null || isFunction(p);\r\n        if (!valid) {\r\n            throw 'Expected a Function.';\r\n        }\r\n    }\r\n    return new ArgSpec(validator, optional);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns a function that invokes f with its arguments asynchronously as a\r\n * microtask, i.e. as soon as possible after the current script returns back\r\n * into browser code.\r\n */\r\n// eslint-disable-next-line @typescript-eslint/ban-types\r\nfunction async(f) {\r\n    return function () {\r\n        var argsToForward = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            argsToForward[_i] = arguments[_i];\r\n        }\r\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n        Promise.resolve().then(function () { return f.apply(void 0, argsToForward); });\r\n    };\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Represents a blob being uploaded. Can be used to pause/resume/cancel the\r\n * upload and manage callbacks for various events.\r\n */\r\nvar UploadTask = /** @class */ (function () {\r\n    /**\r\n     * @param ref The firebaseStorage.Reference object this task came\r\n     *     from, untyped to avoid cyclic dependencies.\r\n     * @param blob The blob to upload.\r\n     */\r\n    function UploadTask(ref, service, location, mappings, blob, metadata) {\r\n        var _this = this;\r\n        if (metadata === void 0) { metadata = null; }\r\n        this.transferred_ = 0;\r\n        this.needToFetchStatus_ = false;\r\n        this.needToFetchMetadata_ = false;\r\n        this.observers_ = [];\r\n        this.error_ = null;\r\n        this.uploadUrl_ = null;\r\n        this.request_ = null;\r\n        this.chunkMultiplier_ = 1;\r\n        this.resolve_ = null;\r\n        this.reject_ = null;\r\n        this.ref_ = ref;\r\n        this.service_ = service;\r\n        this.location_ = location;\r\n        this.blob_ = blob;\r\n        this.metadata_ = metadata;\r\n        this.mappings_ = mappings;\r\n        this.resumable_ = this.shouldDoResumable_(this.blob_);\r\n        this.state_ = InternalTaskState.RUNNING;\r\n        this.errorHandler_ = function (error) {\r\n            _this.request_ = null;\r\n            _this.chunkMultiplier_ = 1;\r\n            if (error.codeEquals(Code.CANCELED)) {\r\n                _this.needToFetchStatus_ = true;\r\n                _this.completeTransitions_();\r\n            }\r\n            else {\r\n                _this.error_ = error;\r\n                _this.transition_(InternalTaskState.ERROR);\r\n            }\r\n        };\r\n        this.metadataErrorHandler_ = function (error) {\r\n            _this.request_ = null;\r\n            if (error.codeEquals(Code.CANCELED)) {\r\n                _this.completeTransitions_();\r\n            }\r\n            else {\r\n                _this.error_ = error;\r\n                _this.transition_(InternalTaskState.ERROR);\r\n            }\r\n        };\r\n        this.promise_ = new Promise(function (resolve, reject) {\r\n            _this.resolve_ = resolve;\r\n            _this.reject_ = reject;\r\n            _this.start_();\r\n        });\r\n        // Prevent uncaught rejections on the internal promise from bubbling out\r\n        // to the top level with a dummy handler.\r\n        this.promise_.then(null, function () { });\r\n    }\r\n    UploadTask.prototype.makeProgressCallback_ = function () {\r\n        var _this = this;\r\n        var sizeBefore = this.transferred_;\r\n        return function (loaded) { return _this.updateProgress_(sizeBefore + loaded); };\r\n    };\r\n    UploadTask.prototype.shouldDoResumable_ = function (blob) {\r\n        return blob.size() > 256 * 1024;\r\n    };\r\n    UploadTask.prototype.start_ = function () {\r\n        if (this.state_ !== InternalTaskState.RUNNING) {\r\n            // This can happen if someone pauses us in a resume callback, for example.\r\n            return;\r\n        }\r\n        if (this.request_ !== null) {\r\n            return;\r\n        }\r\n        if (this.resumable_) {\r\n            if (this.uploadUrl_ === null) {\r\n                this.createResumable_();\r\n            }\r\n            else {\r\n                if (this.needToFetchStatus_) {\r\n                    this.fetchStatus_();\r\n                }\r\n                else {\r\n                    if (this.needToFetchMetadata_) {\r\n                        // Happens if we miss the metadata on upload completion.\r\n                        this.fetchMetadata_();\r\n                    }\r\n                    else {\r\n                        this.continueUpload_();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            this.oneShotUpload_();\r\n        }\r\n    };\r\n    UploadTask.prototype.resolveToken_ = function (callback) {\r\n        var _this = this;\r\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n        this.service_.getAuthToken().then(function (authToken) {\r\n            switch (_this.state_) {\r\n                case InternalTaskState.RUNNING:\r\n                    callback(authToken);\r\n                    break;\r\n                case InternalTaskState.CANCELING:\r\n                    _this.transition_(InternalTaskState.CANCELED);\r\n                    break;\r\n                case InternalTaskState.PAUSING:\r\n                    _this.transition_(InternalTaskState.PAUSED);\r\n                    break;\r\n            }\r\n        });\r\n    };\r\n    // TODO(andysoto): assert false\r\n    UploadTask.prototype.createResumable_ = function () {\r\n        var _this = this;\r\n        this.resolveToken_(function (authToken) {\r\n            var requestInfo = createResumableUpload(_this.service_, _this.location_, _this.mappings_, _this.blob_, _this.metadata_);\r\n            var createRequest = _this.service_.makeRequest(requestInfo, authToken);\r\n            _this.request_ = createRequest;\r\n            createRequest.getPromise().then(function (url) {\r\n                _this.request_ = null;\r\n                _this.uploadUrl_ = url;\r\n                _this.needToFetchStatus_ = false;\r\n                _this.completeTransitions_();\r\n            }, _this.errorHandler_);\r\n        });\r\n    };\r\n    UploadTask.prototype.fetchStatus_ = function () {\r\n        var _this = this;\r\n        // TODO(andysoto): assert(this.uploadUrl_ !== null);\r\n        var url = this.uploadUrl_;\r\n        this.resolveToken_(function (authToken) {\r\n            var requestInfo = getResumableUploadStatus(_this.service_, _this.location_, url, _this.blob_);\r\n            var statusRequest = _this.service_.makeRequest(requestInfo, authToken);\r\n            _this.request_ = statusRequest;\r\n            statusRequest.getPromise().then(function (status) {\r\n                status = status;\r\n                _this.request_ = null;\r\n                _this.updateProgress_(status.current);\r\n                _this.needToFetchStatus_ = false;\r\n                if (status.finalized) {\r\n                    _this.needToFetchMetadata_ = true;\r\n                }\r\n                _this.completeTransitions_();\r\n            }, _this.errorHandler_);\r\n        });\r\n    };\r\n    UploadTask.prototype.continueUpload_ = function () {\r\n        var _this = this;\r\n        var chunkSize = resumableUploadChunkSize * this.chunkMultiplier_;\r\n        var status = new ResumableUploadStatus(this.transferred_, this.blob_.size());\r\n        // TODO(andysoto): assert(this.uploadUrl_ !== null);\r\n        var url = this.uploadUrl_;\r\n        this.resolveToken_(function (authToken) {\r\n            var requestInfo;\r\n            try {\r\n                requestInfo = continueResumableUpload(_this.location_, _this.service_, url, _this.blob_, chunkSize, _this.mappings_, status, _this.makeProgressCallback_());\r\n            }\r\n            catch (e) {\r\n                _this.error_ = e;\r\n                _this.transition_(InternalTaskState.ERROR);\r\n                return;\r\n            }\r\n            var uploadRequest = _this.service_.makeRequest(requestInfo, authToken);\r\n            _this.request_ = uploadRequest;\r\n            uploadRequest\r\n                .getPromise()\r\n                .then(function (newStatus) {\r\n                _this.increaseMultiplier_();\r\n                _this.request_ = null;\r\n                _this.updateProgress_(newStatus.current);\r\n                if (newStatus.finalized) {\r\n                    _this.metadata_ = newStatus.metadata;\r\n                    _this.transition_(InternalTaskState.SUCCESS);\r\n                }\r\n                else {\r\n                    _this.completeTransitions_();\r\n                }\r\n            }, _this.errorHandler_);\r\n        });\r\n    };\r\n    UploadTask.prototype.increaseMultiplier_ = function () {\r\n        var currentSize = resumableUploadChunkSize * this.chunkMultiplier_;\r\n        // Max chunk size is 32M.\r\n        if (currentSize < 32 * 1024 * 1024) {\r\n            this.chunkMultiplier_ *= 2;\r\n        }\r\n    };\r\n    UploadTask.prototype.fetchMetadata_ = function () {\r\n        var _this = this;\r\n        this.resolveToken_(function (authToken) {\r\n            var requestInfo = getMetadata(_this.service_, _this.location_, _this.mappings_);\r\n            var metadataRequest = _this.service_.makeRequest(requestInfo, authToken);\r\n            _this.request_ = metadataRequest;\r\n            metadataRequest.getPromise().then(function (metadata) {\r\n                _this.request_ = null;\r\n                _this.metadata_ = metadata;\r\n                _this.transition_(InternalTaskState.SUCCESS);\r\n            }, _this.metadataErrorHandler_);\r\n        });\r\n    };\r\n    UploadTask.prototype.oneShotUpload_ = function () {\r\n        var _this = this;\r\n        this.resolveToken_(function (authToken) {\r\n            var requestInfo = multipartUpload(_this.service_, _this.location_, _this.mappings_, _this.blob_, _this.metadata_);\r\n            var multipartRequest = _this.service_.makeRequest(requestInfo, authToken);\r\n            _this.request_ = multipartRequest;\r\n            multipartRequest.getPromise().then(function (metadata) {\r\n                _this.request_ = null;\r\n                _this.metadata_ = metadata;\r\n                _this.updateProgress_(_this.blob_.size());\r\n                _this.transition_(InternalTaskState.SUCCESS);\r\n            }, _this.errorHandler_);\r\n        });\r\n    };\r\n    UploadTask.prototype.updateProgress_ = function (transferred) {\r\n        var old = this.transferred_;\r\n        this.transferred_ = transferred;\r\n        // A progress update can make the \"transferred\" value smaller (e.g. a\r\n        // partial upload not completed by server, after which the \"transferred\"\r\n        // value may reset to the value at the beginning of the request).\r\n        if (this.transferred_ !== old) {\r\n            this.notifyObservers_();\r\n        }\r\n    };\r\n    UploadTask.prototype.transition_ = function (state) {\r\n        if (this.state_ === state) {\r\n            return;\r\n        }\r\n        switch (state) {\r\n            case InternalTaskState.CANCELING:\r\n                // TODO(andysoto):\r\n                // assert(this.state_ === InternalTaskState.RUNNING ||\r\n                //        this.state_ === InternalTaskState.PAUSING);\r\n                this.state_ = state;\r\n                if (this.request_ !== null) {\r\n                    this.request_.cancel();\r\n                }\r\n                break;\r\n            case InternalTaskState.PAUSING:\r\n                // TODO(andysoto):\r\n                // assert(this.state_ === InternalTaskState.RUNNING);\r\n                this.state_ = state;\r\n                if (this.request_ !== null) {\r\n                    this.request_.cancel();\r\n                }\r\n                break;\r\n            case InternalTaskState.RUNNING:\r\n                // TODO(andysoto):\r\n                // assert(this.state_ === InternalTaskState.PAUSED ||\r\n                //        this.state_ === InternalTaskState.PAUSING);\r\n                var wasPaused = this.state_ === InternalTaskState.PAUSED;\r\n                this.state_ = state;\r\n                if (wasPaused) {\r\n                    this.notifyObservers_();\r\n                    this.start_();\r\n                }\r\n                break;\r\n            case InternalTaskState.PAUSED:\r\n                // TODO(andysoto):\r\n                // assert(this.state_ === InternalTaskState.PAUSING);\r\n                this.state_ = state;\r\n                this.notifyObservers_();\r\n                break;\r\n            case InternalTaskState.CANCELED:\r\n                // TODO(andysoto):\r\n                // assert(this.state_ === InternalTaskState.PAUSED ||\r\n                //        this.state_ === InternalTaskState.CANCELING);\r\n                this.error_ = canceled();\r\n                this.state_ = state;\r\n                this.notifyObservers_();\r\n                break;\r\n            case InternalTaskState.ERROR:\r\n                // TODO(andysoto):\r\n                // assert(this.state_ === InternalTaskState.RUNNING ||\r\n                //        this.state_ === InternalTaskState.PAUSING ||\r\n                //        this.state_ === InternalTaskState.CANCELING);\r\n                this.state_ = state;\r\n                this.notifyObservers_();\r\n                break;\r\n            case InternalTaskState.SUCCESS:\r\n                // TODO(andysoto):\r\n                // assert(this.state_ === InternalTaskState.RUNNING ||\r\n                //        this.state_ === InternalTaskState.PAUSING ||\r\n                //        this.state_ === InternalTaskState.CANCELING);\r\n                this.state_ = state;\r\n                this.notifyObservers_();\r\n                break;\r\n        }\r\n    };\r\n    UploadTask.prototype.completeTransitions_ = function () {\r\n        switch (this.state_) {\r\n            case InternalTaskState.PAUSING:\r\n                this.transition_(InternalTaskState.PAUSED);\r\n                break;\r\n            case InternalTaskState.CANCELING:\r\n                this.transition_(InternalTaskState.CANCELED);\r\n                break;\r\n            case InternalTaskState.RUNNING:\r\n                this.start_();\r\n                break;\r\n        }\r\n    };\r\n    Object.defineProperty(UploadTask.prototype, \"snapshot\", {\r\n        get: function () {\r\n            var externalState = taskStateFromInternalTaskState(this.state_);\r\n            return new UploadTaskSnapshot(this.transferred_, this.blob_.size(), externalState, this.metadata_, this, this.ref_);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Adds a callback for an event.\r\n     * @param type The type of event to listen for.\r\n     */\r\n    UploadTask.prototype.on = function (type, nextOrObserver, error, completed) {\r\n        function typeValidator() {\r\n            if (type !== TaskEvent.STATE_CHANGED) {\r\n                throw \"Expected one of the event types: [\" + TaskEvent.STATE_CHANGED + \"].\";\r\n            }\r\n        }\r\n        var nextOrObserverMessage = 'Expected a function or an Object with one of ' +\r\n            '`next`, `error`, `complete` properties.';\r\n        var nextValidator = nullFunctionSpec(true).validator;\r\n        var observerValidator = looseObjectSpec(null, true).validator;\r\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n        function nextOrObserverValidator(p) {\r\n            try {\r\n                nextValidator(p);\r\n                return;\r\n            }\r\n            catch (e) { }\r\n            try {\r\n                observerValidator(p);\r\n                var anyDefined = isJustDef(p['next']) ||\r\n                    isJustDef(p['error']) ||\r\n                    isJustDef(p['complete']);\r\n                if (!anyDefined) {\r\n                    throw '';\r\n                }\r\n                return;\r\n            }\r\n            catch (e) {\r\n                throw nextOrObserverMessage;\r\n            }\r\n        }\r\n        var specs = [\r\n            stringSpec(typeValidator),\r\n            looseObjectSpec(nextOrObserverValidator, true),\r\n            nullFunctionSpec(true),\r\n            nullFunctionSpec(true)\r\n        ];\r\n        validate('on', specs, arguments);\r\n        var self = this;\r\n        function makeBinder(specs) {\r\n            function binder(nextOrObserver, error, complete) {\r\n                if (specs !== null) {\r\n                    validate('on', specs, arguments);\r\n                }\r\n                var observer = new Observer(nextOrObserver, error, completed);\r\n                self.addObserver_(observer);\r\n                return function () {\r\n                    self.removeObserver_(observer);\r\n                };\r\n            }\r\n            return binder;\r\n        }\r\n        function binderNextOrObserverValidator(p) {\r\n            if (p === null) {\r\n                throw nextOrObserverMessage;\r\n            }\r\n            nextOrObserverValidator(p);\r\n        }\r\n        var binderSpecs = [\r\n            looseObjectSpec(binderNextOrObserverValidator),\r\n            nullFunctionSpec(true),\r\n            nullFunctionSpec(true)\r\n        ];\r\n        var typeOnly = !(isJustDef(nextOrObserver) ||\r\n            isJustDef(error) ||\r\n            isJustDef(completed));\r\n        if (typeOnly) {\r\n            return makeBinder(binderSpecs);\r\n        }\r\n        else {\r\n            return makeBinder(null)(nextOrObserver, error, completed);\r\n        }\r\n    };\r\n    /**\r\n     * This object behaves like a Promise, and resolves with its snapshot data\r\n     * when the upload completes.\r\n     * @param onFulfilled The fulfillment callback. Promise chaining works as normal.\r\n     * @param onRejected The rejection callback.\r\n     */\r\n    UploadTask.prototype.then = function (onFulfilled, onRejected) {\r\n        // These casts are needed so that TypeScript can infer the types of the\r\n        // resulting Promise.\r\n        return this.promise_.then(onFulfilled, onRejected);\r\n    };\r\n    /**\r\n     * Equivalent to calling `then(null, onRejected)`.\r\n     */\r\n    UploadTask.prototype.catch = function (onRejected) {\r\n        return this.then(null, onRejected);\r\n    };\r\n    /**\r\n     * Adds the given observer.\r\n     */\r\n    UploadTask.prototype.addObserver_ = function (observer) {\r\n        this.observers_.push(observer);\r\n        this.notifyObserver_(observer);\r\n    };\r\n    /**\r\n     * Removes the given observer.\r\n     */\r\n    UploadTask.prototype.removeObserver_ = function (observer) {\r\n        var i = this.observers_.indexOf(observer);\r\n        if (i !== -1) {\r\n            this.observers_.splice(i, 1);\r\n        }\r\n    };\r\n    UploadTask.prototype.notifyObservers_ = function () {\r\n        var _this = this;\r\n        this.finishPromise_();\r\n        var observers = this.observers_.slice();\r\n        observers.forEach(function (observer) {\r\n            _this.notifyObserver_(observer);\r\n        });\r\n    };\r\n    UploadTask.prototype.finishPromise_ = function () {\r\n        if (this.resolve_ !== null) {\r\n            var triggered = true;\r\n            switch (taskStateFromInternalTaskState(this.state_)) {\r\n                case TaskState.SUCCESS:\r\n                    async(this.resolve_.bind(null, this.snapshot))();\r\n                    break;\r\n                case TaskState.CANCELED:\r\n                case TaskState.ERROR:\r\n                    var toCall = this.reject_;\r\n                    async(toCall.bind(null, this.error_))();\r\n                    break;\r\n                default:\r\n                    triggered = false;\r\n                    break;\r\n            }\r\n            if (triggered) {\r\n                this.resolve_ = null;\r\n                this.reject_ = null;\r\n            }\r\n        }\r\n    };\r\n    UploadTask.prototype.notifyObserver_ = function (observer) {\r\n        var externalState = taskStateFromInternalTaskState(this.state_);\r\n        switch (externalState) {\r\n            case TaskState.RUNNING:\r\n            case TaskState.PAUSED:\r\n                if (observer.next) {\r\n                    async(observer.next.bind(observer, this.snapshot))();\r\n                }\r\n                break;\r\n            case TaskState.SUCCESS:\r\n                if (observer.complete) {\r\n                    async(observer.complete.bind(observer))();\r\n                }\r\n                break;\r\n            case TaskState.CANCELED:\r\n            case TaskState.ERROR:\r\n                if (observer.error) {\r\n                    async(observer.error.bind(observer, this.error_))();\r\n                }\r\n                break;\r\n            default:\r\n                // TODO(andysoto): assert(false);\r\n                if (observer.error) {\r\n                    async(observer.error.bind(observer, this.error_))();\r\n                }\r\n        }\r\n    };\r\n    /**\r\n     * Resumes a paused task. Has no effect on a currently running or failed task.\r\n     * @return True if the operation took effect, false if ignored.\r\n     */\r\n    UploadTask.prototype.resume = function () {\r\n        validate('resume', [], arguments);\r\n        var valid = this.state_ === InternalTaskState.PAUSED ||\r\n            this.state_ === InternalTaskState.PAUSING;\r\n        if (valid) {\r\n            this.transition_(InternalTaskState.RUNNING);\r\n        }\r\n        return valid;\r\n    };\r\n    /**\r\n     * Pauses a currently running task. Has no effect on a paused or failed task.\r\n     * @return True if the operation took effect, false if ignored.\r\n     */\r\n    UploadTask.prototype.pause = function () {\r\n        validate('pause', [], arguments);\r\n        var valid = this.state_ === InternalTaskState.RUNNING;\r\n        if (valid) {\r\n            this.transition_(InternalTaskState.PAUSING);\r\n        }\r\n        return valid;\r\n    };\r\n    /**\r\n     * Cancels a currently running or paused task. Has no effect on a complete or\r\n     * failed task.\r\n     * @return True if the operation took effect, false if ignored.\r\n     */\r\n    UploadTask.prototype.cancel = function () {\r\n        validate('cancel', [], arguments);\r\n        var valid = this.state_ === InternalTaskState.RUNNING ||\r\n            this.state_ === InternalTaskState.PAUSING;\r\n        if (valid) {\r\n            this.transition_(InternalTaskState.CANCELING);\r\n        }\r\n        return valid;\r\n    };\r\n    return UploadTask;\r\n}());\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Provides methods to interact with a bucket in the Firebase Storage service.\r\n * @param location An fbs.location, or the URL at\r\n *     which to base this object, in one of the following forms:\r\n *         gs://<bucket>/<object-path>\r\n *         http[s]://firebasestorage.googleapis.com/\r\n *                     <api-version>/b/<bucket>/o/<object-path>\r\n *     Any query or fragment strings will be ignored in the http[s]\r\n *     format. If no value is passed, the storage object will use a URL based on\r\n *     the project ID of the base firebase.App instance.\r\n */\r\nvar Reference = /** @class */ (function () {\r\n    function Reference(service, location) {\r\n        this.service = service;\r\n        if (location instanceof Location) {\r\n            this.location = location;\r\n        }\r\n        else {\r\n            this.location = Location.makeFromUrl(location);\r\n        }\r\n    }\r\n    /**\r\n     * @return The URL for the bucket and path this object references,\r\n     *     in the form gs://<bucket>/<object-path>\r\n     * @override\r\n     */\r\n    Reference.prototype.toString = function () {\r\n        validate('toString', [], arguments);\r\n        return 'gs://' + this.location.bucket + '/' + this.location.path;\r\n    };\r\n    Reference.prototype.newRef = function (service, location) {\r\n        return new Reference(service, location);\r\n    };\r\n    Reference.prototype.mappings = function () {\r\n        return getMappings();\r\n    };\r\n    /**\r\n     * @return A reference to the object obtained by\r\n     *     appending childPath, removing any duplicate, beginning, or trailing\r\n     *     slashes.\r\n     */\r\n    Reference.prototype.child = function (childPath) {\r\n        validate('child', [stringSpec()], arguments);\r\n        var newPath = child(this.location.path, childPath);\r\n        var location = new Location(this.location.bucket, newPath);\r\n        return this.newRef(this.service, location);\r\n    };\r\n    Object.defineProperty(Reference.prototype, \"parent\", {\r\n        /**\r\n         * @return A reference to the parent of the\r\n         *     current object, or null if the current object is the root.\r\n         */\r\n        get: function () {\r\n            var newPath = parent(this.location.path);\r\n            if (newPath === null) {\r\n                return null;\r\n            }\r\n            var location = new Location(this.location.bucket, newPath);\r\n            return this.newRef(this.service, location);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Reference.prototype, \"root\", {\r\n        /**\r\n         * @return An reference to the root of this\r\n         *     object's bucket.\r\n         */\r\n        get: function () {\r\n            var location = new Location(this.location.bucket, '');\r\n            return this.newRef(this.service, location);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Reference.prototype, \"bucket\", {\r\n        get: function () {\r\n            return this.location.bucket;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Reference.prototype, \"fullPath\", {\r\n        get: function () {\r\n            return this.location.path;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Reference.prototype, \"name\", {\r\n        get: function () {\r\n            return lastComponent(this.location.path);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Reference.prototype, \"storage\", {\r\n        get: function () {\r\n            return this.service;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Uploads a blob to this object's location.\r\n     * @param data The blob to upload.\r\n     * @return An UploadTask that lets you control and\r\n     *     observe the upload.\r\n     */\r\n    Reference.prototype.put = function (data, metadata) {\r\n        if (metadata === void 0) { metadata = null; }\r\n        validate('put', [uploadDataSpec(), metadataSpec(true)], arguments);\r\n        this.throwIfRoot_('put');\r\n        return new UploadTask(this, this.service, this.location, this.mappings(), new FbsBlob(data), metadata);\r\n    };\r\n    /**\r\n     * Uploads a string to this object's location.\r\n     * @param value The string to upload.\r\n     * @param format The format of the string to upload.\r\n     * @return An UploadTask that lets you control and\r\n     *     observe the upload.\r\n     */\r\n    Reference.prototype.putString = function (value, format, metadata) {\r\n        if (format === void 0) { format = StringFormat.RAW; }\r\n        validate('putString', [stringSpec(), stringSpec(formatValidator, true), metadataSpec(true)], arguments);\r\n        this.throwIfRoot_('putString');\r\n        var data = dataFromString(format, value);\r\n        var metadataClone = Object.assign({}, metadata);\r\n        if (!isDef(metadataClone['contentType']) &&\r\n            isDef(data.contentType)) {\r\n            metadataClone['contentType'] = data.contentType;\r\n        }\r\n        return new UploadTask(this, this.service, this.location, this.mappings(), new FbsBlob(data.data, true), metadataClone);\r\n    };\r\n    /**\r\n     * Deletes the object at this location.\r\n     * @return A promise that resolves if the deletion succeeds.\r\n     */\r\n    Reference.prototype.delete = function () {\r\n        var _this = this;\r\n        validate('delete', [], arguments);\r\n        this.throwIfRoot_('delete');\r\n        return this.service.getAuthToken().then(function (authToken) {\r\n            var requestInfo = deleteObject(_this.service, _this.location);\r\n            return _this.service.makeRequest(requestInfo, authToken).getPromise();\r\n        });\r\n    };\r\n    /**\r\n     * List all items (files) and prefixes (folders) under this storage reference.\r\n     *\r\n     * This is a helper method for calling list() repeatedly until there are\r\n     * no more results. The default pagination size is 1000.\r\n     *\r\n     * Note: The results may not be consistent if objects are changed while this\r\n     * operation is running.\r\n     *\r\n     * Warning: listAll may potentially consume too many resources if there are\r\n     * too many results.\r\n     *\r\n     * @return A Promise that resolves with all the items and prefixes under\r\n     *      the current storage reference. `prefixes` contains references to\r\n     *      sub-directories and `items` contains references to objects in this\r\n     *      folder. `nextPageToken` is never returned.\r\n     */\r\n    Reference.prototype.listAll = function () {\r\n        validate('listAll', [], arguments);\r\n        var accumulator = {\r\n            prefixes: [],\r\n            items: []\r\n        };\r\n        return this.listAllHelper(accumulator).then(function () { return accumulator; });\r\n    };\r\n    Reference.prototype.listAllHelper = function (accumulator, pageToken) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var opt, nextPage;\r\n            var _a, _b;\r\n            return __generator(this, function (_c) {\r\n                switch (_c.label) {\r\n                    case 0:\r\n                        opt = {\r\n                            // maxResults is 1000 by default.\r\n                            pageToken: pageToken\r\n                        };\r\n                        return [4 /*yield*/, this.list(opt)];\r\n                    case 1:\r\n                        nextPage = _c.sent();\r\n                        (_a = accumulator.prefixes).push.apply(_a, nextPage.prefixes);\r\n                        (_b = accumulator.items).push.apply(_b, nextPage.items);\r\n                        if (!(nextPage.nextPageToken != null)) return [3 /*break*/, 3];\r\n                        return [4 /*yield*/, this.listAllHelper(accumulator, nextPage.nextPageToken)];\r\n                    case 2:\r\n                        _c.sent();\r\n                        _c.label = 3;\r\n                    case 3: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * List items (files) and prefixes (folders) under this storage reference.\r\n     *\r\n     * List API is only available for Firebase Rules Version 2.\r\n     *\r\n     * GCS is a key-blob store. Firebase Storage imposes the semantic of '/'\r\n     * delimited folder structure.\r\n     * Refer to GCS's List API if you want to learn more.\r\n     *\r\n     * To adhere to Firebase Rules's Semantics, Firebase Storage does not\r\n     * support objects whose paths end with \"/\" or contain two consecutive\r\n     * \"/\"s. Firebase Storage List API will filter these unsupported objects.\r\n     * list() may fail if there are too many unsupported objects in the bucket.\r\n     *\r\n     * @param options See ListOptions for details.\r\n     * @return A Promise that resolves with the items and prefixes.\r\n     *      `prefixes` contains references to sub-folders and `items`\r\n     *      contains references to objects in this folder. `nextPageToken`\r\n     *      can be used to get the rest of the results.\r\n     */\r\n    Reference.prototype.list = function (options) {\r\n        validate('list', [listOptionSpec(true)], arguments);\r\n        var self = this;\r\n        return this.service.getAuthToken().then(function (authToken) {\r\n            var op = options || {};\r\n            var requestInfo = list(self.service, self.location, \r\n            /*delimiter= */ '/', op.pageToken, op.maxResults);\r\n            return self.service.makeRequest(requestInfo, authToken).getPromise();\r\n        });\r\n    };\r\n    /**\r\n     *     A promise that resolves with the metadata for this object. If this\r\n     *     object doesn't exist or metadata cannot be retreived, the promise is\r\n     *     rejected.\r\n     */\r\n    Reference.prototype.getMetadata = function () {\r\n        var _this = this;\r\n        validate('getMetadata', [], arguments);\r\n        this.throwIfRoot_('getMetadata');\r\n        return this.service.getAuthToken().then(function (authToken) {\r\n            var requestInfo = getMetadata(_this.service, _this.location, _this.mappings());\r\n            return _this.service.makeRequest(requestInfo, authToken).getPromise();\r\n        });\r\n    };\r\n    /**\r\n     * Updates the metadata for this object.\r\n     * @param metadata The new metadata for the object.\r\n     *     Only values that have been explicitly set will be changed. Explicitly\r\n     *     setting a value to null will remove the metadata.\r\n     * @return A promise that resolves\r\n     *     with the new metadata for this object.\r\n     *     @see firebaseStorage.Reference.prototype.getMetadata\r\n     */\r\n    Reference.prototype.updateMetadata = function (metadata) {\r\n        var _this = this;\r\n        validate('updateMetadata', [metadataSpec()], arguments);\r\n        this.throwIfRoot_('updateMetadata');\r\n        return this.service.getAuthToken().then(function (authToken) {\r\n            var requestInfo = updateMetadata(_this.service, _this.location, metadata, _this.mappings());\r\n            return _this.service.makeRequest(requestInfo, authToken).getPromise();\r\n        });\r\n    };\r\n    /**\r\n     * @return A promise that resolves with the download\r\n     *     URL for this object.\r\n     */\r\n    Reference.prototype.getDownloadURL = function () {\r\n        var _this = this;\r\n        validate('getDownloadURL', [], arguments);\r\n        this.throwIfRoot_('getDownloadURL');\r\n        return this.service.getAuthToken().then(function (authToken) {\r\n            var requestInfo = getDownloadUrl(_this.service, _this.location, _this.mappings());\r\n            return _this.service\r\n                .makeRequest(requestInfo, authToken)\r\n                .getPromise()\r\n                .then(function (url) {\r\n                if (url === null) {\r\n                    throw noDownloadURL();\r\n                }\r\n                return url;\r\n            });\r\n        });\r\n    };\r\n    Reference.prototype.throwIfRoot_ = function (name) {\r\n        if (this.location.path === '') {\r\n            throw invalidRootOperation(name);\r\n        }\r\n    };\r\n    return Reference;\r\n}());\n\n/**\r\n * A request whose promise always fails.\r\n * @struct\r\n * @template T\r\n */\r\nvar FailRequest = /** @class */ (function () {\r\n    function FailRequest(error) {\r\n        this.promise_ = Promise.reject(error);\r\n    }\r\n    /** @inheritDoc */\r\n    FailRequest.prototype.getPromise = function () {\r\n        return this.promise_;\r\n    };\r\n    /** @inheritDoc */\r\n    FailRequest.prototype.cancel = function (_appDelete) {\r\n    };\r\n    return FailRequest;\r\n}());\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @param f May be invoked\r\n *     before the function returns.\r\n * @param callback Get all the arguments passed to the function\r\n *     passed to f, including the initial boolean.\r\n */\r\nfunction start(f, \r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\ncallback, timeout) {\r\n    // TODO(andysoto): make this code cleaner (probably refactor into an actual\r\n    // type instead of a bunch of functions with state shared in the closure)\r\n    var waitSeconds = 1;\r\n    // Would type this as \"number\" but that doesn't work for Node so ¯\\_(ツ)_/¯\r\n    // TODO: find a way to exclude Node type definition for storage because storage only works in browser\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    var timeoutId = null;\r\n    var hitTimeout = false;\r\n    var cancelState = 0;\r\n    function canceled() {\r\n        return cancelState === 2;\r\n    }\r\n    var triggeredCallback = false;\r\n    // TODO: This disable can be removed and the 'ignoreRestArgs' option added to\r\n    // the no-explicit-any rule when ESlint releases it.\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    function triggerCallback() {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        if (!triggeredCallback) {\r\n            triggeredCallback = true;\r\n            callback.apply(null, args);\r\n        }\r\n    }\r\n    function callWithDelay(millis) {\r\n        timeoutId = setTimeout(function () {\r\n            timeoutId = null;\r\n            f(handler, canceled());\r\n        }, millis);\r\n    }\r\n    // TODO: This disable can be removed and the 'ignoreRestArgs' option added to\r\n    // the no-explicit-any rule when ESlint releases it.\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    function handler(success) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        if (triggeredCallback) {\r\n            return;\r\n        }\r\n        if (success) {\r\n            triggerCallback.call.apply(triggerCallback, __spreadArrays([null, success], args));\r\n            return;\r\n        }\r\n        var mustStop = canceled() || hitTimeout;\r\n        if (mustStop) {\r\n            triggerCallback.call.apply(triggerCallback, __spreadArrays([null, success], args));\r\n            return;\r\n        }\r\n        if (waitSeconds < 64) {\r\n            /* TODO(andysoto): don't back off so quickly if we know we're offline. */\r\n            waitSeconds *= 2;\r\n        }\r\n        var waitMillis;\r\n        if (cancelState === 1) {\r\n            cancelState = 2;\r\n            waitMillis = 0;\r\n        }\r\n        else {\r\n            waitMillis = (waitSeconds + Math.random()) * 1000;\r\n        }\r\n        callWithDelay(waitMillis);\r\n    }\r\n    var stopped = false;\r\n    function stop(wasTimeout) {\r\n        if (stopped) {\r\n            return;\r\n        }\r\n        stopped = true;\r\n        if (triggeredCallback) {\r\n            return;\r\n        }\r\n        if (timeoutId !== null) {\r\n            if (!wasTimeout) {\r\n                cancelState = 2;\r\n            }\r\n            clearTimeout(timeoutId);\r\n            callWithDelay(0);\r\n        }\r\n        else {\r\n            if (!wasTimeout) {\r\n                cancelState = 1;\r\n            }\r\n        }\r\n    }\r\n    callWithDelay(0);\r\n    setTimeout(function () {\r\n        hitTimeout = true;\r\n        stop(true);\r\n    }, timeout);\r\n    return stop;\r\n}\r\n/**\r\n * Stops the retry loop from repeating.\r\n * If the function is currently \"in between\" retries, it is invoked immediately\r\n * with the second parameter as \"true\". Otherwise, it will be invoked once more\r\n * after the current invocation finishes iff the current invocation would have\r\n * triggered another retry.\r\n */\r\nfunction stop(id) {\r\n    id(false);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @struct\r\n * @template T\r\n */\r\nvar NetworkRequest = /** @class */ (function () {\r\n    function NetworkRequest(url, method, headers, body, successCodes, additionalRetryCodes, callback, errorCallback, timeout, progressCallback, pool) {\r\n        var _this = this;\r\n        this.pendingXhr_ = null;\r\n        this.backoffId_ = null;\r\n        this.canceled_ = false;\r\n        this.appDelete_ = false;\r\n        this.url_ = url;\r\n        this.method_ = method;\r\n        this.headers_ = headers;\r\n        this.body_ = body;\r\n        this.successCodes_ = successCodes.slice();\r\n        this.additionalRetryCodes_ = additionalRetryCodes.slice();\r\n        this.callback_ = callback;\r\n        this.errorCallback_ = errorCallback;\r\n        this.progressCallback_ = progressCallback;\r\n        this.timeout_ = timeout;\r\n        this.pool_ = pool;\r\n        this.promise_ = new Promise(function (resolve, reject) {\r\n            _this.resolve_ = resolve;\r\n            _this.reject_ = reject;\r\n            _this.start_();\r\n        });\r\n    }\r\n    /**\r\n     * Actually starts the retry loop.\r\n     */\r\n    NetworkRequest.prototype.start_ = function () {\r\n        var self = this;\r\n        function doTheRequest(backoffCallback, canceled) {\r\n            if (canceled) {\r\n                backoffCallback(false, new RequestEndStatus(false, null, true));\r\n                return;\r\n            }\r\n            var xhr = self.pool_.createXhrIo();\r\n            self.pendingXhr_ = xhr;\r\n            function progressListener(progressEvent) {\r\n                var loaded = progressEvent.loaded;\r\n                var total = progressEvent.lengthComputable ? progressEvent.total : -1;\r\n                if (self.progressCallback_ !== null) {\r\n                    self.progressCallback_(loaded, total);\r\n                }\r\n            }\r\n            if (self.progressCallback_ !== null) {\r\n                xhr.addUploadProgressListener(progressListener);\r\n            }\r\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n            xhr\r\n                .send(self.url_, self.method_, self.body_, self.headers_)\r\n                .then(function (xhr) {\r\n                if (self.progressCallback_ !== null) {\r\n                    xhr.removeUploadProgressListener(progressListener);\r\n                }\r\n                self.pendingXhr_ = null;\r\n                xhr = xhr;\r\n                var hitServer = xhr.getErrorCode() === ErrorCode.NO_ERROR;\r\n                var status = xhr.getStatus();\r\n                if (!hitServer || self.isRetryStatusCode_(status)) {\r\n                    var wasCanceled = xhr.getErrorCode() === ErrorCode.ABORT;\r\n                    backoffCallback(false, new RequestEndStatus(false, null, wasCanceled));\r\n                    return;\r\n                }\r\n                var successCode = self.successCodes_.indexOf(status) !== -1;\r\n                backoffCallback(true, new RequestEndStatus(successCode, xhr));\r\n            });\r\n        }\r\n        /**\r\n         * @param requestWentThrough True if the request eventually went\r\n         *     through, false if it hit the retry limit or was canceled.\r\n         */\r\n        function backoffDone(requestWentThrough, status) {\r\n            var resolve = self.resolve_;\r\n            var reject = self.reject_;\r\n            var xhr = status.xhr;\r\n            if (status.wasSuccessCode) {\r\n                try {\r\n                    var result = self.callback_(xhr, xhr.getResponseText());\r\n                    if (isJustDef(result)) {\r\n                        resolve(result);\r\n                    }\r\n                    else {\r\n                        resolve();\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    reject(e);\r\n                }\r\n            }\r\n            else {\r\n                if (xhr !== null) {\r\n                    var err = unknown();\r\n                    err.setServerResponseProp(xhr.getResponseText());\r\n                    if (self.errorCallback_) {\r\n                        reject(self.errorCallback_(xhr, err));\r\n                    }\r\n                    else {\r\n                        reject(err);\r\n                    }\r\n                }\r\n                else {\r\n                    if (status.canceled) {\r\n                        var err = self.appDelete_ ? appDeleted() : canceled();\r\n                        reject(err);\r\n                    }\r\n                    else {\r\n                        var err = retryLimitExceeded();\r\n                        reject(err);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (this.canceled_) {\r\n            backoffDone(false, new RequestEndStatus(false, null, true));\r\n        }\r\n        else {\r\n            this.backoffId_ = start(doTheRequest, backoffDone, this.timeout_);\r\n        }\r\n    };\r\n    /** @inheritDoc */\r\n    NetworkRequest.prototype.getPromise = function () {\r\n        return this.promise_;\r\n    };\r\n    /** @inheritDoc */\r\n    NetworkRequest.prototype.cancel = function (appDelete) {\r\n        this.canceled_ = true;\r\n        this.appDelete_ = appDelete || false;\r\n        if (this.backoffId_ !== null) {\r\n            stop(this.backoffId_);\r\n        }\r\n        if (this.pendingXhr_ !== null) {\r\n            this.pendingXhr_.abort();\r\n        }\r\n    };\r\n    NetworkRequest.prototype.isRetryStatusCode_ = function (status) {\r\n        // The codes for which to retry came from this page:\r\n        // https://cloud.google.com/storage/docs/exponential-backoff\r\n        var isFiveHundredCode = status >= 500 && status < 600;\r\n        var extraRetryCodes = [\r\n            // Request Timeout: web server didn't receive full request in time.\r\n            408,\r\n            // Too Many Requests: you're getting rate-limited, basically.\r\n            429\r\n        ];\r\n        var isExtraRetryCode = extraRetryCodes.indexOf(status) !== -1;\r\n        var isRequestSpecificRetryCode = this.additionalRetryCodes_.indexOf(status) !== -1;\r\n        return isFiveHundredCode || isExtraRetryCode || isRequestSpecificRetryCode;\r\n    };\r\n    return NetworkRequest;\r\n}());\r\n/**\r\n * A collection of information about the result of a network request.\r\n * @param opt_canceled Defaults to false.\r\n * @struct\r\n */\r\nvar RequestEndStatus = /** @class */ (function () {\r\n    function RequestEndStatus(wasSuccessCode, xhr, canceled) {\r\n        this.wasSuccessCode = wasSuccessCode;\r\n        this.xhr = xhr;\r\n        this.canceled = !!canceled;\r\n    }\r\n    return RequestEndStatus;\r\n}());\r\nfunction addAuthHeader_(headers, authToken) {\r\n    if (authToken !== null && authToken.length > 0) {\r\n        headers['Authorization'] = 'Firebase ' + authToken;\r\n    }\r\n}\r\nfunction addVersionHeader_(headers) {\r\n    var version = typeof firebase !== 'undefined' ? firebase.SDK_VERSION : 'AppManager';\r\n    headers['X-Firebase-Storage-Version'] = 'webjs/' + version;\r\n}\r\nfunction addGmpidHeader_(headers, appId) {\r\n    if (appId) {\r\n        headers['X-Firebase-GMPID'] = appId;\r\n    }\r\n}\r\n/**\r\n * @template T\r\n */\r\nfunction makeRequest(requestInfo, appId, authToken, pool) {\r\n    var queryPart = makeQueryString(requestInfo.urlParams);\r\n    var url = requestInfo.url + queryPart;\r\n    var headers = Object.assign({}, requestInfo.headers);\r\n    addGmpidHeader_(headers, appId);\r\n    addAuthHeader_(headers, authToken);\r\n    addVersionHeader_(headers);\r\n    return new NetworkRequest(url, requestInfo.method, headers, requestInfo.body, requestInfo.successCodes, requestInfo.additionalRetryCodes, requestInfo.handler, requestInfo.errorHandler, requestInfo.timeout, requestInfo.progressCallback, pool);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * A service that provides firebaseStorage.Reference instances.\r\n * @param opt_url gs:// url to a custom Storage Bucket\r\n *\r\n * @struct\r\n */\r\nvar StorageService = /** @class */ (function () {\r\n    function StorageService(app, authProvider, pool, url) {\r\n        var _a;\r\n        this.bucket_ = null;\r\n        this.appId_ = null;\r\n        this.deleted_ = false;\r\n        this.app_ = app;\r\n        this.authProvider_ = authProvider;\r\n        this.maxOperationRetryTime_ = DEFAULT_MAX_OPERATION_RETRY_TIME;\r\n        this.maxUploadRetryTime_ = DEFAULT_MAX_UPLOAD_RETRY_TIME;\r\n        this.requests_ = new Set();\r\n        this.pool_ = pool;\r\n        if (url != null) {\r\n            this.bucket_ = Location.makeFromBucketSpec(url);\r\n        }\r\n        else {\r\n            this.bucket_ = StorageService.extractBucket_((_a = this.app_) === null || _a === void 0 ? void 0 : _a.options);\r\n        }\r\n        this.internals_ = new ServiceInternals(this);\r\n    }\r\n    StorageService.extractBucket_ = function (config) {\r\n        var bucketString = config === null || config === void 0 ? void 0 : config[CONFIG_STORAGE_BUCKET_KEY];\r\n        if (bucketString == null) {\r\n            return null;\r\n        }\r\n        return Location.makeFromBucketSpec(bucketString);\r\n    };\r\n    StorageService.prototype.getAuthToken = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var auth, tokenData;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        auth = this.authProvider_.getImmediate({ optional: true });\r\n                        if (!auth) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, auth.getToken()];\r\n                    case 1:\r\n                        tokenData = _a.sent();\r\n                        if (tokenData !== null) {\r\n                            return [2 /*return*/, tokenData.accessToken];\r\n                        }\r\n                        _a.label = 2;\r\n                    case 2: return [2 /*return*/, null];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Stop running requests and prevent more from being created.\r\n     */\r\n    StorageService.prototype.deleteApp = function () {\r\n        this.deleted_ = true;\r\n        this.app_ = null;\r\n        this.requests_.forEach(function (request) { return request.cancel(); });\r\n        this.requests_.clear();\r\n    };\r\n    /**\r\n     * Returns a new firebaseStorage.Reference object referencing this StorageService\r\n     * at the given Location.\r\n     * @param loc The Location.\r\n     * @return A firebaseStorage.Reference.\r\n     */\r\n    StorageService.prototype.makeStorageReference = function (loc) {\r\n        return new Reference(this, loc);\r\n    };\r\n    StorageService.prototype.makeRequest = function (requestInfo, authToken) {\r\n        var _this = this;\r\n        if (!this.deleted_) {\r\n            var request_1 = makeRequest(requestInfo, this.appId_, authToken, this.pool_);\r\n            this.requests_.add(request_1);\r\n            // Request removes itself from set when complete.\r\n            request_1.getPromise().then(function () { return _this.requests_.delete(request_1); }, function () { return _this.requests_.delete(request_1); });\r\n            return request_1;\r\n        }\r\n        else {\r\n            return new FailRequest(appDeleted());\r\n        }\r\n    };\r\n    /**\r\n     * Returns a firebaseStorage.Reference for the given path in the default\r\n     * bucket.\r\n     */\r\n    StorageService.prototype.ref = function (path) {\r\n        function validator(path) {\r\n            if (typeof path !== 'string') {\r\n                throw 'Path is not a string.';\r\n            }\r\n            if (/^[A-Za-z]+:\\/\\//.test(path)) {\r\n                throw 'Expected child path but got a URL, use refFromURL instead.';\r\n            }\r\n        }\r\n        validate('ref', [stringSpec(validator, true)], arguments);\r\n        if (this.bucket_ == null) {\r\n            throw new Error('No Storage Bucket defined in Firebase Options.');\r\n        }\r\n        var ref = new Reference(this, this.bucket_);\r\n        if (path != null) {\r\n            return ref.child(path);\r\n        }\r\n        else {\r\n            return ref;\r\n        }\r\n    };\r\n    /**\r\n     * Returns a firebaseStorage.Reference object for the given absolute URL,\r\n     * which must be a gs:// or http[s]:// URL.\r\n     */\r\n    StorageService.prototype.refFromURL = function (url) {\r\n        function validator(p) {\r\n            if (typeof p !== 'string') {\r\n                throw 'Path is not a string.';\r\n            }\r\n            if (!/^[A-Za-z]+:\\/\\//.test(p)) {\r\n                throw 'Expected full URL but got a child path, use ref instead.';\r\n            }\r\n            try {\r\n                Location.makeFromUrl(p);\r\n            }\r\n            catch (e) {\r\n                throw 'Expected valid full URL but got an invalid one.';\r\n            }\r\n        }\r\n        validate('refFromURL', [stringSpec(validator, false)], arguments);\r\n        return new Reference(this, url);\r\n    };\r\n    Object.defineProperty(StorageService.prototype, \"maxUploadRetryTime\", {\r\n        get: function () {\r\n            return this.maxUploadRetryTime_;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    StorageService.prototype.setMaxUploadRetryTime = function (time) {\r\n        validate('setMaxUploadRetryTime', [nonNegativeNumberSpec()], arguments);\r\n        this.maxUploadRetryTime_ = time;\r\n    };\r\n    Object.defineProperty(StorageService.prototype, \"maxOperationRetryTime\", {\r\n        get: function () {\r\n            return this.maxOperationRetryTime_;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    StorageService.prototype.setMaxOperationRetryTime = function (time) {\r\n        validate('setMaxOperationRetryTime', [nonNegativeNumberSpec()], arguments);\r\n        this.maxOperationRetryTime_ = time;\r\n    };\r\n    Object.defineProperty(StorageService.prototype, \"app\", {\r\n        get: function () {\r\n            return this.app_;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(StorageService.prototype, \"INTERNAL\", {\r\n        get: function () {\r\n            return this.internals_;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return StorageService;\r\n}());\r\n/**\r\n * @struct\r\n */\r\nvar ServiceInternals = /** @class */ (function () {\r\n    function ServiceInternals(service) {\r\n        this.service_ = service;\r\n    }\r\n    /**\r\n     * Called when the associated app is deleted.\r\n     */\r\n    ServiceInternals.prototype.delete = function () {\r\n        this.service_.deleteApp();\r\n        return Promise.resolve();\r\n    };\r\n    return ServiceInternals;\r\n}());\n\nvar name = \"@firebase/storage\";\nvar version = \"0.3.43\";\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Type constant for Firebase Storage.\r\n */\r\nvar STORAGE_TYPE = 'storage';\r\nfunction factory(container, url) {\r\n    // Dependencies\r\n    var app = container.getProvider('app').getImmediate();\r\n    var authProvider = container.getProvider('auth-internal');\r\n    return new StorageService(app, authProvider, new XhrIoPool(), url);\r\n}\r\nfunction registerStorage(instance) {\r\n    var namespaceExports = {\r\n        // no-inline\r\n        TaskState: TaskState,\r\n        TaskEvent: TaskEvent,\r\n        StringFormat: StringFormat,\r\n        Storage: StorageService,\r\n        Reference: Reference\r\n    };\r\n    instance.INTERNAL.registerComponent(new Component(STORAGE_TYPE, factory, \"PUBLIC\" /* PUBLIC */)\r\n        .setServiceProps(namespaceExports)\r\n        .setMultipleInstances(true));\r\n    instance.registerVersion(name, version);\r\n}\r\nregisterStorage(firebase);\n\nexport { registerStorage };\n//# sourceMappingURL=index.esm.js.map\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { HelpChatPage } from './help-chat.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: HelpChatPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class HelpChatPageRoutingModule {}\r\n","import { Observable, of, from } from 'rxjs';\nimport { map, observeOn, switchMap } from 'rxjs/operators';\nimport { InjectionToken, Injectable, Inject, Optional, PLATFORM_ID, NgZone, ɵɵdefineInjectable, ɵɵinject, NgModule } from '@angular/core';\nimport { ɵAngularFireSchedulers, ɵkeepUnstableUntilFirstFactory, ɵfirebaseAppFactory, FIREBASE_OPTIONS, FIREBASE_APP_NAME } from '@angular/fire';\nimport 'firebase/storage';\nimport firebase from 'firebase/app';\nimport { registerStorage } from '@firebase/storage';\n\n/**\n * @fileoverview added by tsickle\n * Generated from: observable/fromTask.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @param {?} task\n * @return {?}\n */\nimport * as ɵngcc0 from '@angular/core';\nfunction fromTask(task) {\n    return new Observable((/**\n     * @param {?} subscriber\n     * @return {?}\n     */\n    subscriber => {\n        /** @type {?} */\n        const progress = (/**\n         * @param {?} snap\n         * @return {?}\n         */\n        (snap) => subscriber.next(snap));\n        /** @type {?} */\n        const error = (/**\n         * @param {?} e\n         * @return {?}\n         */\n        e => subscriber.error(e));\n        /** @type {?} */\n        const complete = (/**\n         * @return {?}\n         */\n        () => subscriber.complete());\n        task.on('state_changed', progress, error, (/**\n         * @return {?}\n         */\n        () => {\n            progress(task.snapshot);\n            complete();\n        }));\n        return (/**\n         * @return {?}\n         */\n        () => task.cancel());\n    }));\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: task.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @record\n */\nfunction AngularFireUploadTask() { }\nif (false) {\n    /** @type {?} */\n    AngularFireUploadTask.prototype.task;\n    /**\n     * @return {?}\n     */\n    AngularFireUploadTask.prototype.snapshotChanges = function () { };\n    /**\n     * @return {?}\n     */\n    AngularFireUploadTask.prototype.percentageChanges = function () { };\n    /**\n     * @return {?}\n     */\n    AngularFireUploadTask.prototype.pause = function () { };\n    /**\n     * @return {?}\n     */\n    AngularFireUploadTask.prototype.cancel = function () { };\n    /**\n     * @return {?}\n     */\n    AngularFireUploadTask.prototype.resume = function () { };\n    /**\n     * @param {?=} onFulfilled\n     * @param {?=} onRejected\n     * @return {?}\n     */\n    AngularFireUploadTask.prototype.then = function (onFulfilled, onRejected) { };\n    /**\n     * @param {?} onRejected\n     * @return {?}\n     */\n    AngularFireUploadTask.prototype.catch = function (onRejected) { };\n}\n/**\n * Create an AngularFireUploadTask from a regular UploadTask from the Storage SDK.\n * This method creates an observable of the upload and returns on object that provides\n * multiple methods for controlling and monitoring the file upload.\n * @param {?} task\n * @return {?}\n */\nfunction createUploadTask(task) {\n    /** @type {?} */\n    const inner$ = fromTask(task);\n    return {\n        task,\n        then: task.then.bind(task),\n        catch: task.catch.bind(task),\n        pause: task.pause.bind(task),\n        cancel: task.cancel.bind(task),\n        resume: task.resume.bind(task),\n        snapshotChanges: (/**\n         * @return {?}\n         */\n        () => inner$),\n        percentageChanges: (/**\n         * @return {?}\n         */\n        () => inner$.pipe(map((/**\n         * @param {?} s\n         * @return {?}\n         */\n        s => s.bytesTransferred / s.totalBytes * 100))))\n    };\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: ref.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/**\n * @record\n */\nfunction AngularFireStorageReference() { }\nif (false) {\n    /**\n     * @return {?}\n     */\n    AngularFireStorageReference.prototype.getDownloadURL = function () { };\n    /**\n     * @return {?}\n     */\n    AngularFireStorageReference.prototype.getMetadata = function () { };\n    /**\n     * @return {?}\n     */\n    AngularFireStorageReference.prototype.delete = function () { };\n    /**\n     * @param {?} path\n     * @return {?}\n     */\n    AngularFireStorageReference.prototype.child = function (path) { };\n    /**\n     * @param {?} meta\n     * @return {?}\n     */\n    AngularFireStorageReference.prototype.updateMetadata = function (meta) { };\n    /**\n     * @param {?} data\n     * @param {?=} metadata\n     * @return {?}\n     */\n    AngularFireStorageReference.prototype.put = function (data, metadata) { };\n    /**\n     * @param {?} data\n     * @param {?=} format\n     * @param {?=} metadata\n     * @return {?}\n     */\n    AngularFireStorageReference.prototype.putString = function (data, format, metadata) { };\n    /**\n     * @return {?}\n     */\n    AngularFireStorageReference.prototype.listAll = function () { };\n}\n/**\n * Create an AngularFire wrapped Storage Reference. This object\n * creates observable methods from promise based methods.\n * @param {?} ref\n * @param {?} schedulers\n * @param {?} keepUnstableUntilFirst\n * @return {?}\n */\nfunction createStorageRef(ref, schedulers, keepUnstableUntilFirst) {\n    return {\n        getDownloadURL: (/**\n         * @return {?}\n         */\n        () => of(undefined).pipe(observeOn(schedulers.outsideAngular), switchMap((/**\n         * @return {?}\n         */\n        () => ref.getDownloadURL())), keepUnstableUntilFirst)),\n        getMetadata: (/**\n         * @return {?}\n         */\n        () => of(undefined).pipe(observeOn(schedulers.outsideAngular), switchMap((/**\n         * @return {?}\n         */\n        () => ref.getMetadata())), keepUnstableUntilFirst)),\n        delete: (/**\n         * @return {?}\n         */\n        () => from(ref.delete())),\n        child: (/**\n         * @param {?} path\n         * @return {?}\n         */\n        (path) => createStorageRef(ref.child(path), schedulers, keepUnstableUntilFirst)),\n        updateMetadata: (/**\n         * @param {?} meta\n         * @return {?}\n         */\n        (meta) => from(ref.updateMetadata(meta))),\n        put: (/**\n         * @param {?} data\n         * @param {?=} metadata\n         * @return {?}\n         */\n        (data, metadata) => {\n            /** @type {?} */\n            const task = ref.put(data, metadata);\n            return createUploadTask(task);\n        }),\n        putString: (/**\n         * @param {?} data\n         * @param {?=} format\n         * @param {?=} metadata\n         * @return {?}\n         */\n        (data, format, metadata) => {\n            /** @type {?} */\n            const task = ref.putString(data, format, metadata);\n            return createUploadTask(task);\n        }),\n        listAll: (/**\n         * @return {?}\n         */\n        () => from(ref.listAll()))\n    };\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: storage.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n/** @type {?} */\nconst BUCKET = new InjectionToken('angularfire2.storageBucket');\n/**\n * AngularFireStorage Service\n *\n * This service is the main entry point for this feature module. It provides\n * an API for uploading and downloading binary files from Cloud Storage for\n * Firebase.\n */\nclass AngularFireStorage {\n    /**\n     * @param {?} options\n     * @param {?} nameOrConfig\n     * @param {?} storageBucket\n     * @param {?} platformId\n     * @param {?} zone\n     */\n    constructor(options, nameOrConfig, storageBucket, \n    // tslint:disable-next-line:ban-types\n    platformId, zone) {\n        this.schedulers = new ɵAngularFireSchedulers(zone);\n        this.keepUnstableUntilFirst = ɵkeepUnstableUntilFirstFactory(this.schedulers);\n        this.storage = zone.runOutsideAngular((/**\n         * @return {?}\n         */\n        () => {\n            /** @type {?} */\n            const app = ɵfirebaseAppFactory(options, zone, nameOrConfig);\n            if (registerStorage) {\n                registerStorage((/** @type {?} */ (firebase)));\n            }\n            return app.storage(storageBucket || undefined);\n        }));\n    }\n    /**\n     * @param {?} path\n     * @return {?}\n     */\n    ref(path) {\n        return createStorageRef(this.storage.ref(path), this.schedulers, this.keepUnstableUntilFirst);\n    }\n    /**\n     * @param {?} path\n     * @param {?} data\n     * @param {?=} metadata\n     * @return {?}\n     */\n    upload(path, data, metadata) {\n        /** @type {?} */\n        const storageRef = this.storage.ref(path);\n        /** @type {?} */\n        const ref = createStorageRef(storageRef, this.schedulers, this.keepUnstableUntilFirst);\n        return ref.put(data, metadata);\n    }\n}\nAngularFireStorage.ɵfac = function AngularFireStorage_Factory(t) { return new (t || AngularFireStorage)(ɵngcc0.ɵɵinject(FIREBASE_OPTIONS), ɵngcc0.ɵɵinject(FIREBASE_APP_NAME, 8), ɵngcc0.ɵɵinject(BUCKET, 8), ɵngcc0.ɵɵinject(PLATFORM_ID), ɵngcc0.ɵɵinject(ɵngcc0.NgZone)); };\n/** @nocollapse */\nAngularFireStorage.ctorParameters = () => [\n    { type: undefined, decorators: [{ type: Inject, args: [FIREBASE_OPTIONS,] }] },\n    { type: undefined, decorators: [{ type: Optional }, { type: Inject, args: [FIREBASE_APP_NAME,] }] },\n    { type: undefined, decorators: [{ type: Optional }, { type: Inject, args: [BUCKET,] }] },\n    { type: Object, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] },\n    { type: NgZone }\n];\n/** @nocollapse */ AngularFireStorage.ɵprov = ɵɵdefineInjectable({ factory: function AngularFireStorage_Factory() { return new AngularFireStorage(ɵɵinject(FIREBASE_OPTIONS), ɵɵinject(FIREBASE_APP_NAME, 8), ɵɵinject(BUCKET, 8), ɵɵinject(PLATFORM_ID), ɵɵinject(NgZone)); }, token: AngularFireStorage, providedIn: \"any\" });\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AngularFireStorage, [{\n        type: Injectable,\n        args: [{\n                providedIn: 'any'\n            }]\n    }], function () { return [{ type: undefined, decorators: [{\n                type: Inject,\n                args: [FIREBASE_OPTIONS]\n            }] }, { type: undefined, decorators: [{\n                type: Optional\n            }, {\n                type: Inject,\n                args: [FIREBASE_APP_NAME]\n            }] }, { type: undefined, decorators: [{\n                type: Optional\n            }, {\n                type: Inject,\n                args: [BUCKET]\n            }] }, { type: Object, decorators: [{\n                type: Inject,\n                args: [PLATFORM_ID]\n            }] }, { type: ɵngcc0.NgZone }]; }, null); })();\nif (false) {\n    /** @type {?} */\n    AngularFireStorage.prototype.storage;\n    /** @type {?} */\n    AngularFireStorage.prototype.keepUnstableUntilFirst;\n    /** @type {?} */\n    AngularFireStorage.prototype.schedulers;\n}\n\n/**\n * @fileoverview added by tsickle\n * Generated from: storage.module.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\nclass AngularFireStorageModule {\n}\nAngularFireStorageModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({ type: AngularFireStorageModule });\nAngularFireStorageModule.ɵinj = ɵngcc0.ɵɵdefineInjector({ factory: function AngularFireStorageModule_Factory(t) { return new (t || AngularFireStorageModule)(); }, providers: [AngularFireStorage] });\n/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(AngularFireStorageModule, [{\n        type: NgModule,\n        args: [{\n                providers: [AngularFireStorage]\n            }]\n    }], null, null); })();\n\n/**\n * @fileoverview added by tsickle\n * Generated from: public_api.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\n/**\n * @fileoverview added by tsickle\n * Generated from: angular-fire-storage.ts\n * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\n */\n\nexport { AngularFireStorage, AngularFireStorageModule, BUCKET, createStorageRef, createUploadTask, fromTask };\n\n//# sourceMappingURL=angular-fire-storage.js.map","import '@firebase/storage';\n//# sourceMappingURL=index.esm.js.map\n","import { NgModule } from \"@angular/core\";\r\nimport { CommonModule } from \"@angular/common\";\r\nimport { FormsModule } from \"@angular/forms\";\r\n\r\nimport { IonicModule } from \"@ionic/angular\";\r\n\r\nimport { HelpChatPageRoutingModule } from \"./help-chat-routing.module\";\r\n\r\nimport { HelpChatPage } from \"./help-chat.page\";\r\nimport { ChatBoxComponent } from \"../chat-box/chat-box.component\";\r\n\r\n@NgModule({\r\n  imports: [CommonModule, FormsModule, IonicModule, HelpChatPageRoutingModule],\r\n  declarations: [HelpChatPage, ChatBoxComponent],\r\n})\r\nexport class HelpChatPageModule {}\r\n","export default \":root {\\r\\n  --ion-color-primary: #912775;\\r\\n  --ion-color-primary-rgb: 145, 39, 117;\\r\\n  --ion-color-primary-contrast: #ffffff;\\r\\n  --ion-color-primary-contrast-rgb: 255, 255, 255;\\r\\n  --ion-color-primary-shade: #802267;\\r\\n  --ion-color-primary-tint: #9c3d83;\\r\\n\\r\\n  --ion-color-secondary: #3dc2ff;\\r\\n  --ion-color-secondary-rgb: 61, 194, 255;\\r\\n  --ion-color-secondary-contrast: #ffffff;\\r\\n  --ion-color-secondary-contrast-rgb: 255, 255, 255;\\r\\n  --ion-color-secondary-shade: #36abe0;\\r\\n  --ion-color-secondary-tint: #50c8ff;\\r\\n\\r\\n  --ion-color-tertiary: #5260ff;\\r\\n  --ion-color-tertiary-rgb: 82, 96, 255;\\r\\n  --ion-color-tertiary-contrast: #ffffff;\\r\\n  --ion-color-tertiary-contrast-rgb: 255, 255, 255;\\r\\n  --ion-color-tertiary-shade: #4854e0;\\r\\n  --ion-color-tertiary-tint: #6370ff;\\r\\n\\r\\n  --ion-color-success: #2dd36f;\\r\\n  --ion-color-success-rgb: 45, 211, 111;\\r\\n  --ion-color-success-contrast: #ffffff;\\r\\n  --ion-color-success-contrast-rgb: 255, 255, 255;\\r\\n  --ion-color-success-shade: #28ba62;\\r\\n  --ion-color-success-tint: #42d77d;\\r\\n\\r\\n  --ion-color-warning: #ffc409;\\r\\n  --ion-color-warning-rgb: 255, 196, 9;\\r\\n  --ion-color-warning-contrast: #000000;\\r\\n  --ion-color-warning-contrast-rgb: 0, 0, 0;\\r\\n  --ion-color-warning-shade: #e0ac08;\\r\\n  --ion-color-warning-tint: #ffca22;\\r\\n\\r\\n  --ion-color-danger: #eb445a;\\r\\n  --ion-color-danger-rgb: 235, 68, 90;\\r\\n  --ion-color-danger-contrast: #ffffff;\\r\\n  --ion-color-danger-contrast-rgb: 255, 255, 255;\\r\\n  --ion-color-danger-shade: #cf3c4f;\\r\\n  --ion-color-danger-tint: #ed576b;\\r\\n\\r\\n  --ion-color-dark: #222428;\\r\\n  --ion-color-dark-rgb: 34, 36, 40;\\r\\n  --ion-color-dark-contrast: #ffffff;\\r\\n  --ion-color-dark-contrast-rgb: 255, 255, 255;\\r\\n  --ion-color-dark-shade: #1e2023;\\r\\n  --ion-color-dark-tint: #383a3e;\\r\\n\\r\\n  --ion-color-medium: #92949c;\\r\\n  --ion-color-medium-rgb: 146, 148, 156;\\r\\n  --ion-color-medium-contrast: #ffffff;\\r\\n  --ion-color-medium-contrast-rgb: 255, 255, 255;\\r\\n  --ion-color-medium-shade: #808289;\\r\\n  --ion-color-medium-tint: #9d9fa6;\\r\\n\\r\\n  --ion-color-light: #f4f5f8;\\r\\n  --ion-color-light-rgb: 244, 245, 248;\\r\\n  --ion-color-light-contrast: #000000;\\r\\n  --ion-color-light-contrast-rgb: 0, 0, 0;\\r\\n  --ion-color-light-shade: #d7d8da;\\r\\n  --ion-color-light-tint: #f5f6f9;\\r\\n\\r\\n  ion-input,\\r\\n  ion-textarea {\\r\\n    --background: #fff;\\r\\n    --color: #333;\\r\\n    border-radius: 5px;\\r\\n    background: #fff;\\r\\n    text-indent: 10px;\\r\\n    border: 1px solid #ccc;\\r\\n  }\\r\\n}\\r\\n\\r\\nion-button {\\r\\n  --background-hover: var(--background);\\r\\n}\\r\\n\\r\\nion-item {\\r\\n  --background-hover: var(--background);\\r\\n  --background-activated: var(--background);\\r\\n}\\r\\n\\r\\n.chat-box {\\n  padding: 0.8em;\\n  margin-bottom: 1em;\\n}\\r\\n\\r\\n.chat-box.user {\\n  border-radius: 0.9em 0.9em 0.5em 0.9em;\\n  background: #c8e0f1;\\n}\\r\\n\\r\\n.chat-box.sender {\\n  border-radius: 0.9em 0.9em 0.9em 0.5em;\\n  background: #e586c9;\\n}\\r\\n\\r\\n.detail-info {\\n  display: flex;\\n  align-items: center;\\n  gap: 0.2em;\\n  width: -moz-max-content;\\n  width: max-content;\\n  margin-left: auto;\\n  margin-bottom: 0.5em;\\n}\\r\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3RoZW1lL3ZhcmlhYmxlcy5zY3NzIiwiLi5cXC4uXFwuLlxcY2hhdC1ib3guY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSw0QkFBNEI7RUFDNUIscUNBQXFDO0VBQ3JDLHFDQUFxQztFQUNyQywrQ0FBK0M7RUFDL0Msa0NBQWtDO0VBQ2xDLGlDQUFpQzs7RUFFakMsOEJBQThCO0VBQzlCLHVDQUF1QztFQUN2Qyx1Q0FBdUM7RUFDdkMsaURBQWlEO0VBQ2pELG9DQUFvQztFQUNwQyxtQ0FBbUM7O0VBRW5DLDZCQUE2QjtFQUM3QixxQ0FBcUM7RUFDckMsc0NBQXNDO0VBQ3RDLGdEQUFnRDtFQUNoRCxtQ0FBbUM7RUFDbkMsa0NBQWtDOztFQUVsQyw0QkFBNEI7RUFDNUIscUNBQXFDO0VBQ3JDLHFDQUFxQztFQUNyQywrQ0FBK0M7RUFDL0Msa0NBQWtDO0VBQ2xDLGlDQUFpQzs7RUFFakMsNEJBQTRCO0VBQzVCLG9DQUFvQztFQUNwQyxxQ0FBcUM7RUFDckMseUNBQXlDO0VBQ3pDLGtDQUFrQztFQUNsQyxpQ0FBaUM7O0VBRWpDLDJCQUEyQjtFQUMzQixtQ0FBbUM7RUFDbkMsb0NBQW9DO0VBQ3BDLDhDQUE4QztFQUM5QyxpQ0FBaUM7RUFDakMsZ0NBQWdDOztFQUVoQyx5QkFBeUI7RUFDekIsZ0NBQWdDO0VBQ2hDLGtDQUFrQztFQUNsQyw0Q0FBNEM7RUFDNUMsK0JBQStCO0VBQy9CLDhCQUE4Qjs7RUFFOUIsMkJBQTJCO0VBQzNCLHFDQUFxQztFQUNyQyxvQ0FBb0M7RUFDcEMsOENBQThDO0VBQzlDLGlDQUFpQztFQUNqQyxnQ0FBZ0M7O0VBRWhDLDBCQUEwQjtFQUMxQixvQ0FBb0M7RUFDcEMsbUNBQW1DO0VBQ25DLHVDQUF1QztFQUN2QyxnQ0FBZ0M7RUFDaEMsK0JBQStCOztFQUUvQjs7SUFFRSxrQkFBa0I7SUFDbEIsYUFBYTtJQUNiLGtCQUFrQjtJQUNsQixnQkFBZ0I7SUFDaEIsaUJBQWlCO0lBQ2pCLHNCQUFzQjtFQUN4QjtBQUNGOztBQUVBO0VBQ0UscUNBQXFDO0FBQ3ZDOztBQUVBO0VBQ0UscUNBQXFDO0VBQ3JDLHlDQUF5QztBQUMzQzs7QUNoRkE7RUFDRSxjQUFBO0VBQ0Esa0JBQUE7QUFBRjs7QUFHQTtFQUNFLHNDQUFBO0VBQ0EsbUJBQUE7QUFBRjs7QUFHQTtFQUNFLHNDQUFBO0VBQ0EsbUJBQUE7QUFBRjs7QUFHQTtFQUNFLGFBQUE7RUFDQSxtQkFBQTtFQUNBLFVBQUE7RUFDQSx1QkFBQTtFQUFBLGtCQUFBO0VBQ0EsaUJBQUE7RUFDQSxvQkFBQTtBQUFGIiwiZmlsZSI6ImNoYXQtYm94LmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiOnJvb3Qge1xyXG4gIC0taW9uLWNvbG9yLXByaW1hcnk6ICM5MTI3NzU7XHJcbiAgLS1pb24tY29sb3ItcHJpbWFyeS1yZ2I6IDE0NSwgMzksIDExNztcclxuICAtLWlvbi1jb2xvci1wcmltYXJ5LWNvbnRyYXN0OiAjZmZmZmZmO1xyXG4gIC0taW9uLWNvbG9yLXByaW1hcnktY29udHJhc3QtcmdiOiAyNTUsIDI1NSwgMjU1O1xyXG4gIC0taW9uLWNvbG9yLXByaW1hcnktc2hhZGU6ICM4MDIyNjc7XHJcbiAgLS1pb24tY29sb3ItcHJpbWFyeS10aW50OiAjOWMzZDgzO1xyXG5cclxuICAtLWlvbi1jb2xvci1zZWNvbmRhcnk6ICMzZGMyZmY7XHJcbiAgLS1pb24tY29sb3Itc2Vjb25kYXJ5LXJnYjogNjEsIDE5NCwgMjU1O1xyXG4gIC0taW9uLWNvbG9yLXNlY29uZGFyeS1jb250cmFzdDogI2ZmZmZmZjtcclxuICAtLWlvbi1jb2xvci1zZWNvbmRhcnktY29udHJhc3QtcmdiOiAyNTUsIDI1NSwgMjU1O1xyXG4gIC0taW9uLWNvbG9yLXNlY29uZGFyeS1zaGFkZTogIzM2YWJlMDtcclxuICAtLWlvbi1jb2xvci1zZWNvbmRhcnktdGludDogIzUwYzhmZjtcclxuXHJcbiAgLS1pb24tY29sb3ItdGVydGlhcnk6ICM1MjYwZmY7XHJcbiAgLS1pb24tY29sb3ItdGVydGlhcnktcmdiOiA4MiwgOTYsIDI1NTtcclxuICAtLWlvbi1jb2xvci10ZXJ0aWFyeS1jb250cmFzdDogI2ZmZmZmZjtcclxuICAtLWlvbi1jb2xvci10ZXJ0aWFyeS1jb250cmFzdC1yZ2I6IDI1NSwgMjU1LCAyNTU7XHJcbiAgLS1pb24tY29sb3ItdGVydGlhcnktc2hhZGU6ICM0ODU0ZTA7XHJcbiAgLS1pb24tY29sb3ItdGVydGlhcnktdGludDogIzYzNzBmZjtcclxuXHJcbiAgLS1pb24tY29sb3Itc3VjY2VzczogIzJkZDM2ZjtcclxuICAtLWlvbi1jb2xvci1zdWNjZXNzLXJnYjogNDUsIDIxMSwgMTExO1xyXG4gIC0taW9uLWNvbG9yLXN1Y2Nlc3MtY29udHJhc3Q6ICNmZmZmZmY7XHJcbiAgLS1pb24tY29sb3Itc3VjY2Vzcy1jb250cmFzdC1yZ2I6IDI1NSwgMjU1LCAyNTU7XHJcbiAgLS1pb24tY29sb3Itc3VjY2Vzcy1zaGFkZTogIzI4YmE2MjtcclxuICAtLWlvbi1jb2xvci1zdWNjZXNzLXRpbnQ6ICM0MmQ3N2Q7XHJcblxyXG4gIC0taW9uLWNvbG9yLXdhcm5pbmc6ICNmZmM0MDk7XHJcbiAgLS1pb24tY29sb3Itd2FybmluZy1yZ2I6IDI1NSwgMTk2LCA5O1xyXG4gIC0taW9uLWNvbG9yLXdhcm5pbmctY29udHJhc3Q6ICMwMDAwMDA7XHJcbiAgLS1pb24tY29sb3Itd2FybmluZy1jb250cmFzdC1yZ2I6IDAsIDAsIDA7XHJcbiAgLS1pb24tY29sb3Itd2FybmluZy1zaGFkZTogI2UwYWMwODtcclxuICAtLWlvbi1jb2xvci13YXJuaW5nLXRpbnQ6ICNmZmNhMjI7XHJcblxyXG4gIC0taW9uLWNvbG9yLWRhbmdlcjogI2ViNDQ1YTtcclxuICAtLWlvbi1jb2xvci1kYW5nZXItcmdiOiAyMzUsIDY4LCA5MDtcclxuICAtLWlvbi1jb2xvci1kYW5nZXItY29udHJhc3Q6ICNmZmZmZmY7XHJcbiAgLS1pb24tY29sb3ItZGFuZ2VyLWNvbnRyYXN0LXJnYjogMjU1LCAyNTUsIDI1NTtcclxuICAtLWlvbi1jb2xvci1kYW5nZXItc2hhZGU6ICNjZjNjNGY7XHJcbiAgLS1pb24tY29sb3ItZGFuZ2VyLXRpbnQ6ICNlZDU3NmI7XHJcblxyXG4gIC0taW9uLWNvbG9yLWRhcms6ICMyMjI0Mjg7XHJcbiAgLS1pb24tY29sb3ItZGFyay1yZ2I6IDM0LCAzNiwgNDA7XHJcbiAgLS1pb24tY29sb3ItZGFyay1jb250cmFzdDogI2ZmZmZmZjtcclxuICAtLWlvbi1jb2xvci1kYXJrLWNvbnRyYXN0LXJnYjogMjU1LCAyNTUsIDI1NTtcclxuICAtLWlvbi1jb2xvci1kYXJrLXNoYWRlOiAjMWUyMDIzO1xyXG4gIC0taW9uLWNvbG9yLWRhcmstdGludDogIzM4M2EzZTtcclxuXHJcbiAgLS1pb24tY29sb3ItbWVkaXVtOiAjOTI5NDljO1xyXG4gIC0taW9uLWNvbG9yLW1lZGl1bS1yZ2I6IDE0NiwgMTQ4LCAxNTY7XHJcbiAgLS1pb24tY29sb3ItbWVkaXVtLWNvbnRyYXN0OiAjZmZmZmZmO1xyXG4gIC0taW9uLWNvbG9yLW1lZGl1bS1jb250cmFzdC1yZ2I6IDI1NSwgMjU1LCAyNTU7XHJcbiAgLS1pb24tY29sb3ItbWVkaXVtLXNoYWRlOiAjODA4Mjg5O1xyXG4gIC0taW9uLWNvbG9yLW1lZGl1bS10aW50OiAjOWQ5ZmE2O1xyXG5cclxuICAtLWlvbi1jb2xvci1saWdodDogI2Y0ZjVmODtcclxuICAtLWlvbi1jb2xvci1saWdodC1yZ2I6IDI0NCwgMjQ1LCAyNDg7XHJcbiAgLS1pb24tY29sb3ItbGlnaHQtY29udHJhc3Q6ICMwMDAwMDA7XHJcbiAgLS1pb24tY29sb3ItbGlnaHQtY29udHJhc3QtcmdiOiAwLCAwLCAwO1xyXG4gIC0taW9uLWNvbG9yLWxpZ2h0LXNoYWRlOiAjZDdkOGRhO1xyXG4gIC0taW9uLWNvbG9yLWxpZ2h0LXRpbnQ6ICNmNWY2Zjk7XHJcblxyXG4gIGlvbi1pbnB1dCxcclxuICBpb24tdGV4dGFyZWEge1xyXG4gICAgLS1iYWNrZ3JvdW5kOiAjZmZmO1xyXG4gICAgLS1jb2xvcjogIzMzMztcclxuICAgIGJvcmRlci1yYWRpdXM6IDVweDtcclxuICAgIGJhY2tncm91bmQ6ICNmZmY7XHJcbiAgICB0ZXh0LWluZGVudDogMTBweDtcclxuICAgIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XHJcbiAgfVxyXG59XHJcblxyXG5pb24tYnV0dG9uIHtcclxuICAtLWJhY2tncm91bmQtaG92ZXI6IHZhcigtLWJhY2tncm91bmQpO1xyXG59XHJcblxyXG5pb24taXRlbSB7XHJcbiAgLS1iYWNrZ3JvdW5kLWhvdmVyOiB2YXIoLS1iYWNrZ3JvdW5kKTtcclxuICAtLWJhY2tncm91bmQtYWN0aXZhdGVkOiB2YXIoLS1iYWNrZ3JvdW5kKTtcclxufVxyXG4iLCJAaW1wb3J0IHVybChcIi4uLy4uL3RoZW1lL3ZhcmlhYmxlcy5zY3NzXCIpO1xyXG5cclxuLmNoYXQtYm94IHtcclxuICBwYWRkaW5nOiAwLjhlbTtcclxuICBtYXJnaW4tYm90dG9tOiAxZW07XHJcbn1cclxuXHJcbi5jaGF0LWJveC51c2VyIHtcclxuICBib3JkZXItcmFkaXVzOiAwLjllbSAwLjllbSAwLjVlbSAwLjllbTtcclxuICBiYWNrZ3JvdW5kOiAjYzhlMGYxO1xyXG59XHJcblxyXG4uY2hhdC1ib3guc2VuZGVyIHtcclxuICBib3JkZXItcmFkaXVzOiAwLjllbSAwLjllbSAwLjllbSAwLjVlbTtcclxuICBiYWNrZ3JvdW5kOiAjZTU4NmM5O1xyXG59XHJcblxyXG4uZGV0YWlsLWluZm8ge1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICBnYXA6IDAuMmVtO1xyXG4gIHdpZHRoOiBtYXgtY29udGVudDtcclxuICBtYXJnaW4tbGVmdDogYXV0bztcclxuICBtYXJnaW4tYm90dG9tOiAwLjVlbTtcclxufVxyXG4iXX0= */\";","import { Injectable } from \"@angular/core\";\nimport { AngularFireDatabase, AngularFireList } from \"@angular/fire/database\";\nimport { AngularFireStorage } from \"@angular/fire/storage\";\nimport { Observable } from \"rxjs\";\nimport { finalize } from \"rxjs/operators\";\nimport { map } from \"rxjs/operators\";\n\n@Injectable({\n  providedIn: \"root\",\n})\nexport class HelpChatService {\n  constructor(\n    private db: AngularFireDatabase,\n    private storage: AngularFireStorage\n  ) {}\n\n  createDialog(dialog: any): any {\n    const dialogsRef = this.db.object(\n      \"/dialog/09ca49de-3dc0-42eb-b284-2c2038a45102\"\n    );\n    return dialogsRef.set(dialog);\n  }\n\n  sendMessage(message: string): Promise<any> {\n    const messagesRef: AngularFireList<any> = this.db.list(\"messages\");\n    return messagesRef.push({\n      content: message,\n      timestamp: Date.now(),\n    });\n  }\n\n  uploadFile(file: File): Observable<any> {\n    const filePath = `uploads/${Date.now()}_${file.name}`;\n    const storageRef = this.storage.ref(filePath);\n    const uploadTask = this.storage.upload(filePath, file);\n\n    return uploadTask.snapshotChanges().pipe(\n      finalize(() => {\n        const downloadUrl$ = storageRef.getDownloadURL();\n        downloadUrl$.subscribe((downloadUrl) => {\n          this.db.list(\"messages\").push({\n            content: downloadUrl,\n            timestamp: Date.now(),\n          });\n        });\n      })\n    );\n  }\n\n  getMessages(): Observable<any[]> {\n    return this.db.list(\"/dialog\").valueChanges();\n  }\n}\n"]}