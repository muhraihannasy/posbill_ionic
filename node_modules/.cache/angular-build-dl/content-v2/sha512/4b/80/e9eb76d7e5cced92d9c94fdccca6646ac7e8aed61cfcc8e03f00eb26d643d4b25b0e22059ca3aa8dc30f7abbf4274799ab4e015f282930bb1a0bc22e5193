{"version":3,"sources":["webpack:///src/app/booking-options/booking-options.page.scss","webpack:///src/app/booking-options/booking-options.module.ts","webpack:///src/app/booking-options/booking-options-routing.module.ts","webpack:///src/app/booking-options/booking-options.page.html","webpack:///src/app/booking-options/booking-options.page.ts"],"names":["BookingOptionsPageModule","imports","declarations","routes","path","component","BookingOptionsPageRoutingModule","forChild","exports","BookingOptionsPage","storage","http","global","router","loadingController","platform","nativePageTransitions","company","payment_cash","bookRef","discount","id","name","amount","type","orderType","orderTypeLabel","customer","phone","paymentMethod","paymentMethodChannel","amountReceived","amountChange","backButtonText","backButtonIcon","cash","booking","storageBooking","ready","then","getObject","auth","data","cart","totalAmount","subtotal","totalQty","qty","console","log","order_type","order_type_label","subtotalAfterDiscount","parseInt","serviceCharge","service_charge","tax","selectcashless","total","parseFloat","amountReceivedChange","loadingPresent","outlet","activeOutlet","user","activeUser","processBooking","booking_id","book_number","seq","getYear","getMonth","getDate","getMathRandom","booking_item","orderSubtotal","item","price","product","tempItem","book_time","getDateNow","product_id","cost","note","push","book_ref","outlet_id","customer_id","user_id","unshift","setObject","reqHeader","token","options","headers","post","base_url","subscribe","status","loadingDismiss","navigate","error","tempBookingOffline","direction","duration","slowdownfactor","slidePixels","iosdelay","androiddelay","fixedPixelsTop","fixedPixelsBottom","slide","selector","template"],"mappings":"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","file":"booking-options-booking-options-module-es5.js","sourcesContent":["export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJib29raW5nLW9wdGlvbnMucGFnZS5zY3NzIn0= */\";","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { BookingOptionsPageRoutingModule } from './booking-options-routing.module';\r\n\r\nimport { BookingOptionsPage } from './booking-options.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    BookingOptionsPageRoutingModule\r\n  ],\r\n  declarations: [BookingOptionsPage]\r\n})\r\nexport class BookingOptionsPageModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { BookingOptionsPage } from './booking-options.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: BookingOptionsPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class BookingOptionsPageRoutingModule {}\r\n","export default \"<ion-item lines=\\\"full\\\" mode=\\\"ios\\\" [routerLink]=\\\"['/select-customer/booking-options']\\\" color=\\\"light\\\"><small><ion-text color=\\\"primary\\\">Pelanggan</ion-text></small>\\r\\n  <ion-note slot=\\\"end\\\">{{customer.name}}</ion-note>\\r\\n</ion-item>\\r\\n\\r\\n<ion-content mode=\\\"ios\\\" class=\\\"ion-padding\\\">\\r\\n\\r\\n  <ion-item lines=\\\"none\\\"><ion-label position=\\\"stacked\\\" color=\\\"primary\\\">Nomor meja / referensi / booking</ion-label>\\r\\n    <ion-input type=\\\"text\\\" [(ngModel)]=\\\"bookRef\\\"></ion-input>\\r\\n    <!-- <ion-button slot=\\\"end\\\" fill=\\\"link\\\"><ion-icon name=\\\"grid-outline\\\" slot=\\\"start\\\"></ion-icon> Pilih meja</ion-button> -->\\r\\n  </ion-item>\\r\\n  <br/>\\r\\n\\r\\n  <ion-item-divider>Item pesanan</ion-item-divider>\\r\\n  <ion-item lines=\\\"full\\\" *ngFor=\\\"let item of cart\\\">\\r\\n    <ion-label class=\\\"ion-text-wrap\\\"><strong>{{item.name}} </strong><br/><small>{{item.price}}</small></ion-label>\\r\\n\\r\\n    <ion-text slot=\\\"end\\\" color=\\\"primary\\\">{{item.qty}}</ion-text>\\r\\n  </ion-item>\\r\\n\\r\\n</ion-content>\\r\\n<ion-footer mode=\\\"ios\\\" class=\\\"ion-padding\\\">\\r\\n  <ion-grid>\\r\\n    <ion-row>\\r\\n      <ion-col size=\\\"3\\\">\\r\\n        <ion-button [routerLink]=\\\"['/tabs/tab-pos']\\\" color=\\\"light\\\" expand=\\\"block\\\">\\r\\n        <ion-icon name=\\\"arrow-back-outline\\\"></ion-icon>\\r\\n        </ion-button>\\r\\n\\r\\n      </ion-col>\\r\\n\\r\\n      <ion-col size=\\\"9\\\">\\r\\n        <ion-button (click)=\\\"process()\\\" color=\\\"primary\\\" expand=\\\"block\\\">\\r\\n          <ion-icon name=\\\"save-outline\\\" slot=\\\"start\\\"></ion-icon>\\r\\n            Simpan\\r\\n        </ion-button>\\r\\n      </ion-col>\\r\\n    </ion-row>\\r\\n  </ion-grid>\\r\\n</ion-footer>\\r\\n\";","import { Component, OnInit } from '@angular/core';\r\nimport { StorageService } from '../storage.service';\r\nimport { HttpClient, HttpHeaders, HttpErrorResponse} from \"@angular/common/http\";\r\nimport { GlobalService } from '../global.service';\r\nimport { Router } from '@angular/router';\r\nimport { LoadingController, Platform } from '@ionic/angular';\r\n\r\nimport { NativePageTransitions, NativeTransitionOptions } from '@ionic-native/native-page-transitions/ngx';\r\n\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\n@Component({\r\n  selector: 'app-booking-options',\r\n  templateUrl: './booking-options.page.html',\r\n  styleUrls: ['./booking-options.page.scss'],\r\n})\r\nexport class BookingOptionsPage implements OnInit {\r\n\r\n  auth: any;\r\n  company: any = {payment_cash:1};\r\n\r\n  activeOutlet: any;\r\n  activeUser: any;\r\n\r\n  bookRef: any = '';\r\n\r\n  cart: any;\r\n  subtotal : any;\r\n  subtotalAfterDiscount: any;\r\n  totalAmount: any;\r\n  totalQty: any;\r\n  discount: any = {id:'',name:'',amount:0,type:'Fixed'};\r\n  serviceCharge: any;\r\n  tax: any;\r\n  total: any;\r\n\r\n  orderType: any = \"none\";\r\n  orderTypeLabel: any = \"none\";\r\n\r\n  customer: any= {id:'Walk-in',name:'Walk-in',phone:''};\r\n\r\n  paymentMethod: any = 'Cash';\r\n  paymentMethodChannel: any = 'Cash';\r\n  amountReceived: any = '';\r\n  amountChange: any = 0;\r\n\r\n  backButtonText: any = 'Kembali';\r\n  backButtonIcon: any = 'arrow-back-outline';\r\n\r\n  cash: any = true;\r\n\r\n  // order\r\n  booking: any = [];\r\n  storageBooking: any = [];\r\n\r\n  constructor(\r\n    private storage: StorageService,\r\n    private http: HttpClient,\r\n    public global: GlobalService,\r\n    private router:Router,\r\n    private loadingController: LoadingController,\r\n    private platform: Platform,\r\n    private nativePageTransitions: NativePageTransitions\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n  }\r\n\r\n  ionViewWillEnter() {\r\n    this.platform.ready().then(() => {\r\n\r\n      this.storage.getObject('auth').then((auth) => {\r\n        this.auth = auth;\r\n      });\r\n\r\n      this.storage.getObject('pos_customer').then((data: any) => {\r\n        if(data != null)\r\n        {\r\n          this.customer = data;\r\n        }\r\n      });\r\n\r\n      this.storage.getObject('pos_cart').then((data: any) => {\r\n        if(data != null)\r\n        {\r\n          this.cart = data;\r\n        }\r\n      });\r\n\r\n      this.storage.getObject('pos_subtotal').then((data: any) => {\r\n        this.totalAmount = data.amount;\r\n\r\n        this.subtotal = this.totalAmount;\r\n        this.totalQty = data.qty;\r\n        console.log(data);\r\n      });\r\n\r\n      this.storage.getObject('pos_order_type').then((data: any) => {\r\n        this.orderType = data.order_type;\r\n        this.orderTypeLabel = data.order_type_label;\r\n      });\r\n\r\n      this.storage.getObject('pos_discount').then((data: any) => {\r\n\r\n          if(data != null)\r\n          {\r\n            this.discount = data;\r\n            if(data.type == 'Percentage')\r\n            {\r\n              this.discount.amount = this.subtotal * data.amount / 100;\r\n              this.subtotalAfterDiscount = parseInt(this.subtotal) - parseInt(this.discount.amount);\r\n            }\r\n            else\r\n            {\r\n              this.discount.amount = data.amount;\r\n              this.subtotalAfterDiscount = parseInt(this.subtotal) - parseInt(this.discount.amount);\r\n            }\r\n          }\r\n          else\r\n          {\r\n            this.subtotalAfterDiscount = parseInt(this.subtotal) - parseInt(this.discount.amount);\r\n          }\r\n\r\n\r\n          this.storage.getObject('company').then((data: any) => {\r\n            if(data != null)\r\n            {\r\n              this.company = data;\r\n              this.serviceCharge = this.subtotalAfterDiscount * data.service_charge / 100;\r\n              this.tax = this.subtotalAfterDiscount * data.tax / 100;\r\n\r\n              if(data.payment_cash != 1)\r\n              {\r\n                this.cash == false;\r\n                this.selectcashless();\r\n              }\r\n            }\r\n\r\n            this.total = this.subtotalAfterDiscount + this.serviceCharge + this.tax;\r\n          });\r\n\r\n      });\r\n\r\n    });\r\n    // this.loadingController.dismiss();\r\n  }\r\n\r\n  selectcash()\r\n  {\r\n    this.cash = true;\r\n    this.paymentMethod = 'Cash';\r\n    this.paymentMethodChannel = 'Cash';\r\n  }\r\n\r\n  selectcashless()\r\n  {\r\n    this.cash = false;\r\n    this.paymentMethod = 'Cashless';\r\n    this.paymentMethodChannel = '';\r\n    this.amountReceived = this.total;\r\n  }\r\n\r\n  shortcutAmount(amount)\r\n  {\r\n    this.amountReceived = parseFloat(amount);\r\n    this.amountReceivedChange();\r\n  }\r\n\r\n  amountReceivedChange()\r\n  {\r\n    this.amountReceived = parseFloat(this.amountReceived);\r\n    this.amountChange = this.amountReceived - this.totalAmount;\r\n  }\r\n\r\n  process()\r\n  {\r\n    this.global.loadingPresent('menyimpan booking...');\r\n    this.storage.getObject('booking').then((data: any) => {\r\n      if(data != null)\r\n      {\r\n        this.storageBooking = data;\r\n        this.booking = this.storageBooking;\r\n      }\r\n      this.storage.getObject('outlet_active').then((outlet: any) => {\r\n        this.activeOutlet = outlet;\r\n        this.storage.getObject('user').then((user: any) => {\r\n          this.activeUser = user;\r\n\r\n          this.processBooking();\r\n\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  processBooking()\r\n  {\r\n    var booking_id = uuidv4();\r\n    var book_number = this.company.seq+this.global.getYear()+this.global.getMonth()+this.global.getDate()+this.global.getMathRandom();\r\n\r\n    var booking_item = [];\r\n    var orderSubtotal = 0;\r\n    for (let item of this.cart)\r\n    {\r\n      var subtotal = item.price * item.qty;\r\n      var product = {id:item.id,name:item.name};\r\n      var tempItem = {id: uuidv4(), booking_id: booking_id, book_number: book_number, book_time: this.global.getDateNow(), product_id: item.id, name: item.name, cost: item.cost, price: item.price, qty: item.qty, note:item.note, subtotal: subtotal, product:product};\r\n      booking_item.push(tempItem);\r\n\r\n      orderSubtotal += subtotal;\r\n    }\r\n\r\n    var booking = {\r\n                  id: booking_id,\r\n                  book_number: book_number,\r\n                  book_ref: this.bookRef,\r\n                  book_time: this.global.getDateNow(),\r\n                  outlet_id: this.activeOutlet.id,\r\n                  customer: {id:this.customer.id,name:this.customer.name,phone:this.customer.phone},\r\n                  customer_id: this.customer.id,\r\n                  user_id: this.activeUser.id,\r\n                  order_type: this.orderType,\r\n                  order_type_label: this.orderTypeLabel,\r\n                  booking_item: booking_item,\r\n                  subtotal: orderSubtotal\r\n                };\r\n\r\n    this.booking.unshift(booking);\r\n    this.storage.setObject('booking',this.booking);\r\n\r\n    var reqHeader = new HttpHeaders({\r\n        'Content-Type': 'application/json',\r\n        'Authorization': 'Bearer '+this.auth.token\r\n     });\r\n\r\n    let options = {headers: reqHeader};\r\n    this.http.post(this.global.base_url+'auth/booking/store', booking, options)\r\n       .subscribe((data: any) => {\r\n         console.log(data);\r\n\r\n         if(data.status == 0)\r\n         {\r\n           console.log(data);\r\n         }\r\n         else\r\n         {\r\n           console.log(data);\r\n         }\r\n\r\n         this.global.loadingDismiss();\r\n         this.router.navigate(['/booking-detail/'+booking.id+'/pos']);\r\n\r\n        }, error => {\r\n\r\n        this.storage.getObject('booking_offline').then((data: any) => {\r\n\r\n          console.log(\"bookingoffline\",data);\r\n          if(data == null)\r\n          {\r\n            let tempBookingOffline:any = [];\r\n            tempBookingOffline.push(booking.id);\r\n            this.storage.setObject('booking_offline',tempBookingOffline);\r\n          }\r\n          else\r\n          {\r\n            let tempBookingOffline = data;\r\n            tempBookingOffline.push(booking.id);\r\n            this.storage.setObject('booking_offline',tempBookingOffline);\r\n          }\r\n\r\n          this.global.loadingDismiss();\r\n        this.router.navigate(['/booking-detail/'+booking.id+'/pos']);\r\n\r\n        });\r\n\r\n        console.log(error);\r\n    });\r\n  }\r\n\r\n  ionViewWillLeave() {\r\n\r\n     let options: NativeTransitionOptions = {\r\n        direction: 'left',\r\n        duration: 300,\r\n        slowdownfactor: 0,\r\n        slidePixels: 0,\r\n        iosdelay: 0,\r\n        androiddelay: 0,\r\n        fixedPixelsTop: 0,\r\n        fixedPixelsBottom: 0\r\n       }\r\n\r\n     this.nativePageTransitions.slide(options);\r\n\r\n    }\r\n\r\n}\r\n"]}